"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.DefenderRelayQueryProvider = void 0;
const relayer_1 = require("../relayer");
class DefenderRelayQueryProvider {
    constructor(relayerCredentials) {
        this.id = 1;
        this.relayer = (0, relayer_1.isRelayer)(relayerCredentials) ? relayerCredentials : new relayer_1.Relayer(relayerCredentials);
    }
    sendAsync(payload, callback) {
        return this.send(payload, callback);
    }
    send(payload, callback) {
        const payloadId = typeof payload.id === 'string' ? parseInt(payload.id) : payload.id;
        this.relayer
            .call(payload.method, payload.params ?? [])
            .then((response) => callback(null, {
            ...response,
            id: payloadId ?? response.id ?? this.id++,
        }))
            .catch((err) => callback(err, undefined));
    }
}
exports.DefenderRelayQueryProvider = DefenderRelayQueryProvider;
