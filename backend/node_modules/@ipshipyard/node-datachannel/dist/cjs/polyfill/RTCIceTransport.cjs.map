{"version":3,"file":"RTCIceTransport.cjs","sources":["../../../src/polyfill/RTCIceTransport.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport RTCIceCandidate from './RTCIceCandidate';\n\nexport default class RTCIceTransport extends EventTarget implements globalThis.RTCIceTransport {\n    #pc: globalThis.RTCPeerConnection = null;\n    #extraFunctions = null;\n\n    ongatheringstatechange: ((this: globalThis.RTCIceTransport, ev: Event) => any) | null = null;\n    onselectedcandidatepairchange: ((this: globalThis.RTCIceTransport, ev: Event) => any) | null = null;\n    onstatechange: ((this: globalThis.RTCIceTransport, ev: Event) => any) | null = null;\n\n    constructor(init: { pc: globalThis.RTCPeerConnection, extraFunctions }) {\n        super();\n        this.#pc = init.pc;\n        this.#extraFunctions = init.extraFunctions;\n\n        // forward peerConnection events\n        this.#pc.addEventListener('icegatheringstatechange', () => {\n            this.dispatchEvent(new Event('gatheringstatechange'));\n        });\n        this.#pc.addEventListener('iceconnectionstatechange', () => {\n            this.dispatchEvent(new Event('statechange'));\n        });\n\n        // forward events to properties\n        this.addEventListener('gatheringstatechange', (e) => {\n            if (this.ongatheringstatechange) this.ongatheringstatechange(e);\n        });\n        this.addEventListener('statechange', (e) => {\n            if (this.onstatechange) this.onstatechange(e);\n        });\n    }\n\n    get component(): globalThis.RTCIceComponent {\n        const cp = this.getSelectedCandidatePair();\n        if (!cp) return null;\n        return cp.local.component;\n    }\n\n    get gatheringState(): globalThis.RTCIceGatheringState {\n        return this.#pc ? this.#pc.iceGatheringState : 'new';\n    }\n\n    get role(): string {\n        return this.#pc.localDescription.type == 'offer' ? 'controlling' : 'controlled';\n    }\n\n    get state(): globalThis.RTCIceTransportState {\n        return this.#pc ? this.#pc.iceConnectionState : 'new';\n    }\n\n    getLocalCandidates(): globalThis.RTCIceCandidate[] {\n        return this.#pc ? this.#extraFunctions.localCandidates() : [];\n    }\n\n    getLocalParameters(): any {\n        /** */\n    }\n\n    getRemoteCandidates(): globalThis.RTCIceCandidate[] {\n        return this.#pc ? this.#extraFunctions.remoteCandidates() : [];\n    }\n\n    getRemoteParameters(): any {\n        /** */\n    }\n\n    getSelectedCandidatePair(): globalThis.RTCIceCandidatePair | null {\n        const cp = this.#extraFunctions.selectedCandidatePair();\n        if (!cp) return null;\n        return {\n            local: new RTCIceCandidate({\n                candidate: cp.local.candidate,\n                sdpMid: cp.local.mid,\n            }),\n            remote: new RTCIceCandidate({\n                candidate: cp.remote.candidate,\n                sdpMid: cp.remote.mid,\n            }),\n        };\n    }\n}\n"],"names":["RTCIceCandidate"],"mappings":"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"}