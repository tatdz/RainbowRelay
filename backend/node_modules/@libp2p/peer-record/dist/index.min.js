(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerRecord = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerRecord=(()=>{var rn=Object.defineProperty;var ia=Object.getOwnPropertyDescriptor;var aa=Object.getOwnPropertyNames;var ca=Object.prototype.hasOwnProperty;var ht=(e,t)=>{for(var r in t)rn(e,r,{get:t[r],enumerable:!0})},fa=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of aa(t))!ca.call(e,o)&&o!==r&&rn(e,o,{get:()=>t[o],enumerable:!(n=ia(t,o))||n.enumerable});return e};var ua=e=>fa(rn({},"__esModule",{value:!0}),e);var Nu={};ht(Nu,{PeerRecord:()=>tn,RecordEnvelope:()=>Hr});var nn=Symbol.for("@libp2p/peer-id");var Y=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},le=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var ur=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}};var he=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var fn={};ht(fn,{base58btc:()=>z,base58flickr:()=>ba});var qu=new Uint8Array(0);function jo(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function Tt(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function $o(e){return new TextEncoder().encode(e)}function Zo(e){return new TextDecoder().decode(e)}function la(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function u(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var E=0,m=0,v=0,T=S.length;v!==T&&S[v]===0;)v++,E++;for(var I=(T-v)*f+1>>>0,L=new Uint8Array(I);v!==T;){for(var p=S[v],P=0,D=I-1;(p!==0||P<m)&&D!==-1;D--,P++)p+=256*L[D]>>>0,L[D]=p%a>>>0,p=p/a>>>0;if(p!==0)throw new Error("Non-zero carry");m=P,v++}for(var B=I-m;B!==I&&L[B]===0;)B++;for(var h=c.repeat(E);B<I;++B)h+=e.charAt(L[B]);return h}function g(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var E=0;if(S[E]!==" "){for(var m=0,v=0;S[E]===c;)m++,E++;for(var T=(S.length-E)*l+1>>>0,I=new Uint8Array(T);S[E];){var L=r[S.charCodeAt(E)];if(L===255)return;for(var p=0,P=T-1;(L!==0||p<v)&&P!==-1;P--,p++)L+=a*I[P]>>>0,I[P]=L%256>>>0,L=L/256>>>0;if(L!==0)throw new Error("Non-zero carry");v=p,E++}if(S[E]!==" "){for(var D=T-v;D!==T&&I[D]===0;)D++;for(var B=new Uint8Array(m+(T-D)),h=m;D!==T;)B[h++]=I[D++];return B}}}function b(S){var E=g(S);if(E)return E;throw new Error(`Non-${t} character`)}return{encode:u,decodeUnsafe:g,decode:b}}var ha=la,da=ha,Yo=da;var on=class{name;prefix;baseEncode;constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},sn=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,r,n){this.name=t,this.prefix=r;let o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Xo(this,t)}},an=class{decoders;constructor(t){this.decoders=t}or(t){return Xo(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Xo(e,t){return new an({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}var cn=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new on(t,r,n),this.decoder=new sn(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function de({name:e,prefix:t,encode:r,decode:n}){return new cn(e,t,r,n)}function qt({name:e,prefix:t,alphabet:r}){let{encode:n,decode:o}=Yo(r,e);return de({prefix:t,name:e,encode:n,decode:s=>Tt(o(s))})}function pa(e,t,r,n){let o=e.length;for(;e[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),i=0,a=0,c=0;for(let l=0;l<o;++l){let f=t[e[l]];if(f===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<r|f,i+=r,i>=8&&(i-=8,s[c++]=255&a>>i)}if(i>=r||(255&a<<8-i)!==0)throw new SyntaxError("Unexpected end of data");return s}function ma(e,t,r){let n=t[t.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],i+=8;i>r;)i-=r,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<r-i]),n)for(;(s.length*r&7)!==0;)s+="=";return s}function ya(e){let t={};for(let r=0;r<e.length;++r)t[e[r]]=r;return t}function G({name:e,prefix:t,bitsPerChar:r,alphabet:n}){let o=ya(n);return de({prefix:t,name:e,encode(s){return ma(s,n,r)},decode(s){return pa(s,o,r,e)}})}var z=qt({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ba=qt({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var un={};ht(un,{base32:()=>Vt,base32hex:()=>Ea,base32hexpad:()=>va,base32hexpadupper:()=>Aa,base32hexupper:()=>Sa,base32pad:()=>xa,base32padupper:()=>wa,base32upper:()=>ga,base32z:()=>Ia});var Vt=G({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ga=G({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),xa=G({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),wa=G({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ea=G({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Sa=G({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),va=G({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Aa=G({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ia=G({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ln={};ht(ln,{base36:()=>Oe,base36upper:()=>Ba});var Oe=qt({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ba=qt({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var _a=ts,Jo=128,Ca=127,Ta=~Ca,Da=Math.pow(2,31);function ts(e,t,r){t=t||[],r=r||0;for(var n=r;e>=Da;)t[r++]=e&255|Jo,e/=128;for(;e&Ta;)t[r++]=e&255|Jo,e>>>=7;return t[r]=e|0,ts.bytes=r-n+1,t}var Pa=hn,La=128,Qo=127;function hn(e,n){var r=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw hn.bytes=0,new RangeError("Could not decode varint");i=e[s++],r+=o<28?(i&Qo)<<o:(i&Qo)*Math.pow(2,o),o+=7}while(i>=La);return hn.bytes=s-n,r}var Oa=Math.pow(2,7),Ua=Math.pow(2,14),Ra=Math.pow(2,21),Ka=Math.pow(2,28),Na=Math.pow(2,35),ka=Math.pow(2,42),Ma=Math.pow(2,49),Ha=Math.pow(2,56),qa=Math.pow(2,63),Va=function(e){return e<Oa?1:e<Ua?2:e<Ra?3:e<Ka?4:e<Na?5:e<ka?6:e<Ma?7:e<Ha?8:e<qa?9:10},za={encode:_a,decode:Pa,encodingLength:Va},Fa=za,Ue=Fa;function Re(e,t=0){return[Ue.decode(e,t),Ue.decode.bytes]}function pe(e,t,r=0){return Ue.encode(e,t,r),t}function me(e){return Ue.encodingLength(e)}function wt(e,t){let r=t.byteLength,n=me(e),o=n+me(r),s=new Uint8Array(o+r);return pe(e,s,0),pe(r,s,n),s.set(t,o),new ye(e,r,t,s)}function Ke(e){let t=Tt(e),[r,n]=Re(t),[o,s]=Re(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new ye(r,o,i,t)}function es(e,t){if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&jo(e.bytes,r.bytes)}}var ye=class{code;size;digest;bytes;constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};function rs(e,t){let{bytes:r,version:n}=e;switch(n){case 0:return ja(r,dn(e),t??z.encoder);default:return $a(r,dn(e),t??Vt.encoder)}}var ns=new WeakMap;function dn(e){let t=ns.get(e);if(t==null){let r=new Map;return ns.set(e,r),r}return t}var W=class e{code;version;multihash;bytes;"/";constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==Ne)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Za)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=wt(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n!=null&&t.code===n.code&&t.version===n.version&&es(t.multihash,n.multihash)}toString(t){return rs(this,t)}toJSON(){return{"/":rs(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new e(n,o,s,i??os(n,o,s.bytes))}else if(r[Wa]===!0){let{version:n,multihash:o,code:s}=r,i=Ke(o);return e.create(n,s,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==Ne)throw new Error(`Version 0 CID must use dag-pb (code: ${Ne}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let o=os(t,r,n.bytes);return new e(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,Ne,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,o=Tt(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new ye(r.multihashCode,r.digestSize,s,o);return[r.version===0?e.createV0(i):e.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[u,g]=Re(t.subarray(r));return r+=g,u},o=n(),s=Ne;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),l=r+c,f=l-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:f,size:l}}static parse(t,r){let[n,o]=Ga(t,r),s=e.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return dn(s).set(n,t),s}};function Ga(e,t){switch(e[0]){case"Q":{let r=t??z;return[z.prefix,r.decode(`${z.prefix}${e}`)]}case z.prefix:{let r=t??z;return[z.prefix,r.decode(e)]}case Vt.prefix:{let r=t??Vt;return[Vt.prefix,r.decode(e)]}case Oe.prefix:{let r=t??Oe;return[Oe.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function ja(e,t,r){let{prefix:n}=r;if(n!==z.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=t.get(n);if(o==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return o}function $a(e,t,r){let{prefix:n}=r,o=t.get(n);if(o==null){let s=r.encode(e);return t.set(n,s),s}else return o}var Ne=112,Za=18;function os(e,t,r){let n=me(e),o=n+me(t),s=new Uint8Array(o+r.byteLength);return pe(e,s,0),pe(t,s,n),s.set(r,o),s}var Wa=Symbol.for("@ipld/js-cid/CID");var pn={};ht(pn,{identity:()=>Et});var ss=0,Ya="identity",is=Tt;function Xa(e){return wt(ss,is(e))}var Et={code:ss,name:Ya,encode:is,digest:Xa};function J(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function et(e=0){return new Uint8Array(e)}function dt(e=0){return new Uint8Array(e)}function Dt(e,t){t==null&&(t=e.reduce((o,s)=>o+s.length,0));let r=dt(t),n=0;for(let o of e)r.set(o,n),n+=o.length;return r}var cs=Symbol.for("@achingbrain/uint8arraylist");function as(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let o=r+n.byteLength;if(t<o)return{buf:n,index:t-r};r=o}throw new RangeError("index is out of bounds")}function hr(e){return!!e?.[cs]}var ft=class e{bufs;length;[cs]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(hr(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(hr(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=as(this.bufs,t);return r.buf[r.index]}set(t,r){let n=as(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(hr(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:o}=this._subList(t,r);return Dt(n,o)}subarray(t,r){let{bufs:n,length:o}=this._subList(t,r);return n.length===1?n[0]:Dt(n,o)}sublist(t,r){let{bufs:n,length:o}=this._subList(t,r),s=new e;return s.length=o,s.bufs=[...n],s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let s=0;s<this.bufs.length;s++){let i=this.bufs[s],a=o,c=a+i.byteLength;if(o=c,t>=c)continue;let l=t>=a&&t<c,f=r>a&&r<=c;if(l&&f){if(t===a&&r===c){n.push(i);break}let u=t-a;n.push(i.subarray(u,u+(r-t)));break}if(l){if(t===0){n.push(i);continue}n.push(i.subarray(t-a));continue}if(f){if(r===c){n.push(i);break}n.push(i.subarray(0,r-a));break}n.push(i)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!hr(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let s=256,i=new Int32Array(s);for(let u=0;u<s;u++)i[u]=-1;for(let u=0;u<o;u++)i[n[u]]=u;let a=i,c=this.byteLength-n.byteLength,l=n.byteLength-1,f;for(let u=r;u<=c;u+=f){f=0;for(let g=l;g>=0;g--){let b=this.get(u+g);if(n[g]!==b){f=Math.max(1,g-a[b]);break}}if(f===0)return u}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=dt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let o=et(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,r,n),this.write(o,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let o=et(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,r,n),this.write(o,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let o=et(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,r,n),this.write(o,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=dt(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let o=et(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,r,n),this.write(o,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let o=et(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,r,n),this.write(o,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let o=et(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,r,n),this.write(o,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let o=et(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,r,n),this.write(o,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let o=et(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,r,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof e)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!J(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new e;return n.bufs=t,r==null&&(r=t.reduce((o,s)=>o+s.byteLength,0)),n.length=r,n}};var mn={};ht(mn,{base10:()=>Ja});var Ja=qt({prefix:"9",name:"base10",alphabet:"0123456789"});var yn={};ht(yn,{base16:()=>Qa,base16upper:()=>tc});var Qa=G({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tc=G({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var bn={};ht(bn,{base2:()=>ec});var ec=G({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var gn={};ht(gn,{base256emoji:()=>ic});var fs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),rc=fs.reduce((e,t,r)=>(e[r]=t,e),[]),nc=fs.reduce((e,t,r)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return e[n]=r,e},[]);function oc(e){return e.reduce((t,r)=>(t+=rc[r],t),"")}function sc(e){let t=[];for(let r of e){let n=r.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${r}`);let o=nc[n];if(o==null)throw new Error(`Non-base256emoji character: ${r}`);t.push(o)}return new Uint8Array(t)}var ic=de({prefix:"\u{1F680}",name:"base256emoji",encode:oc,decode:sc});var wn={};ht(wn,{base64:()=>ac,base64pad:()=>cc,base64url:()=>xn,base64urlpad:()=>fc});var ac=G({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),cc=G({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xn=G({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),fc=G({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var En={};ht(En,{base8:()=>uc});var uc=G({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Sn={};ht(Sn,{identity:()=>lc});var lc=de({prefix:"\0",name:"identity",encode:e=>Zo(e),decode:e=>$o(e)});var Al=new TextEncoder,Il=new TextDecoder;var In={};ht(In,{sha256:()=>ke,sha512:()=>pc});function An({name:e,code:t,encode:r}){return new vn(e,t,r)}var vn=class{name;code;encode;constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?wt(this.code,r):r.then(n=>wt(this.code,n))}else throw Error("Unknown type, must be binary type")}};function ls(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}var ke=An({name:"sha2-256",code:18,encode:ls("SHA-256")}),pc=An({name:"sha2-512",code:19,encode:ls("SHA-512")});var Me={...Sn,...bn,...En,...mn,...yn,...un,...ln,...fn,...wn,...gn},Nl={...In,...pn};function ds(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var hs=ds("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Bn=ds("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=dt(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),mc={utf8:hs,"utf-8":hs,hex:Me.base16,latin1:Bn,ascii:Bn,binary:Bn,...Me},dr=mc;function N(e,t="utf8"){let r=dr[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}function K(e,t="utf8"){let r=dr[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}var yc=parseInt("11111",2),_n=parseInt("10000000",2),bc=parseInt("01111111",2),ps={0:He,1:He,2:gc,3:Ec,4:Sc,5:wc,6:xc,16:He,22:He,48:He};function Pt(e,t={offset:0}){let r=e[t.offset]&yc;if(t.offset++,ps[r]!=null)return ps[r](e,t);throw new Error("No decoder for tag "+r)}function qe(e,t){let r=0;if((e[t.offset]&_n)===_n){let n=e[t.offset]&bc,o="0x";t.offset++;for(let s=0;s<n;s++,t.offset++)o+=e[t.offset].toString(16).padStart(2,"0");r=parseInt(o,16)}else r=e[t.offset],t.offset++;return r}function He(e,t){qe(e,t);let r=[];for(;!(t.offset>=e.byteLength);){let n=Pt(e,t);if(n===null)break;r.push(n)}return r}function gc(e,t){let r=qe(e,t),n=t.offset,o=t.offset+r,s=[];for(let i=n;i<o;i++)i===n&&e[i]===0||s.push(e[i]);return t.offset+=r,Uint8Array.from(s)}function xc(e,t){let r=qe(e,t),n=t.offset+r,o=e[t.offset];t.offset++;let s=0,i=0;o<40?(s=0,i=o):o<80?(s=1,i=o-40):(s=2,i=o-80);let a=`${s}.${i}`,c=[];for(;t.offset<n;){let l=e[t.offset];if(t.offset++,c.push(l&127),l<128){c.reverse();let f=0;for(let u=0;u<c.length;u++)f+=c[u]<<u*7;a+=`.${f}`,c=[]}}return a}function wc(e,t){return t.offset++,null}function Ec(e,t){let r=qe(e,t),n=e[t.offset];t.offset++;let o=e.subarray(t.offset,t.offset+r-1);if(t.offset+=r,n!==0)throw new Error("Unused bits in bit string is unimplemented");return o}function Sc(e,t){let r=qe(e,t),n=e.subarray(t.offset,t.offset+r);return t.offset+=r,n}function vc(e){let t=e.toString(16);t.length%2===1&&(t="0"+t);let r=new ft;for(let n=0;n<t.length;n+=2)r.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return r}function Cn(e){if(e.byteLength<128)return Uint8Array.from([e.byteLength]);let t=vc(e.byteLength);return new ft(Uint8Array.from([t.byteLength|_n]),t)}function pt(e){let t=new ft,r=128;return(e.subarray()[0]&r)===r&&t.append(Uint8Array.from([0])),t.append(e),new ft(Uint8Array.from([2]),Cn(t),t)}function pr(e){let t=Uint8Array.from([0]),r=new ft(t,e);return new ft(Uint8Array.from([3]),Cn(r),r)}function zt(e,t=48){let r=new ft;for(let n of e)r.append(n);return new ft(Uint8Array.from([t]),Cn(r),r)}async function ms(e,t,r,n){let o=await crypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:e.crv??"P-256"},!1,["verify"]);n?.signal?.throwIfAborted();let s=await crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},o,t,r.subarray());return n?.signal?.throwIfAborted(),s}var Ac=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),Ic=Uint8Array.from([6,5,43,129,4,0,34]),Bc=Uint8Array.from([6,5,43,129,4,0,35]),_c={ext:!0,kty:"EC",crv:"P-256"},Cc={ext:!0,kty:"EC",crv:"P-384"},Tc={ext:!0,kty:"EC",crv:"P-521"},Tn=32,Dn=48,Pn=66;function Ln(e){let t=Pt(e);return ys(t)}function ys(e){let t=e[1][1][0],r=1,n,o;if(t.byteLength===Tn*2+1)return n=K(t.subarray(r,r+Tn),"base64url"),o=K(t.subarray(r+Tn),"base64url"),new be({..._c,key_ops:["verify"],x:n,y:o});if(t.byteLength===Dn*2+1)return n=K(t.subarray(r,r+Dn),"base64url"),o=K(t.subarray(r+Dn),"base64url"),new be({...Cc,key_ops:["verify"],x:n,y:o});if(t.byteLength===Pn*2+1)return n=K(t.subarray(r,r+Pn),"base64url"),o=K(t.subarray(r+Pn),"base64url"),new be({...Tc,key_ops:["verify"],x:n,y:o});throw new Y(`coordinates were wrong length, got ${t.byteLength}, expected 65, 97 or 133`)}function bs(e){return zt([pt(Uint8Array.from([1])),zt([Dc(e.crv)],160),zt([pr(new ft(Uint8Array.from([4]),N(e.x??"","base64url"),N(e.y??"","base64url")))],161)]).subarray()}function Dc(e){if(e==="P-256")return Ac;if(e==="P-384")return Ic;if(e==="P-521")return Bc;throw new Y(`Invalid curve ${e}`)}var be=class{type="ECDSA";jwk;_raw;constructor(t){this.jwk=t}get raw(){return this._raw==null&&(this._raw=bs(this.jwk)),this._raw}toMultihash(){return Et.digest(Ft(this))}toCID(){return W.createV1(114,this.toMultihash())}toString(){return z.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:J(this.raw,t.raw)}async verify(t,r,n){return ms(this.jwk,r,t,n)}};var Qt=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function xe(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ve(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function st(e,...t){if(!xe(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function xs(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Ve(e.outputLen),Ve(e.blockLen)}function we(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function ws(e,t){st(e);let r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Ot(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function mr(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function St(e,t){return e<<32-t|e>>>t}var Es=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Pc=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function It(e){if(st(e),Es)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Pc[e[r]];return t}var Lt={_0:48,_9:57,A:65,F:70,a:97,f:102};function gs(e){if(e>=Lt._0&&e<=Lt._9)return e-Lt._0;if(e>=Lt.A&&e<=Lt.F)return e-(Lt.A-10);if(e>=Lt.a&&e<=Lt.f)return e-(Lt.a-10)}function Ee(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(Es)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){let i=gs(e.charCodeAt(s)),a=gs(e.charCodeAt(s+1));if(i===void 0||a===void 0){let c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[o]=i*16+a}return n}function Ss(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function ze(e){return typeof e=="string"&&(e=Ss(e)),st(e),e}function mt(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];st(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let s=e[n];r.set(s,o),o+=s.length}return r}var ge=class{};function On(e){let t=n=>e().update(ze(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function Fe(e=32){if(Qt&&typeof Qt.getRandomValues=="function")return Qt.getRandomValues(new Uint8Array(e));if(Qt&&typeof Qt.randomBytes=="function")return Uint8Array.from(Qt.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}function Lc(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),s=BigInt(4294967295),i=Number(r>>o&s),a=Number(r&s),c=n?4:0,l=n?0:4;e.setUint32(t+c,i,n),e.setUint32(t+l,a,n)}function vs(e,t,r){return e&t^~e&r}function As(e,t,r){return e&t^e&r^t&r}var Ge=class extends ge{constructor(t,r,n,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=mr(this.buffer)}update(t){we(this),t=ze(t),st(t);let{view:r,buffer:n,blockLen:o}=this,s=t.length;for(let i=0;i<s;){let a=Math.min(o-this.pos,s-i);if(a===o){let c=mr(t);for(;o<=s-i;i+=o)this.process(c,i);continue}n.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){we(this),ws(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:s}=this,{pos:i}=this;r[i++]=128,Ot(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(n,0),i=0);for(let u=i;u<o;u++)r[u]=0;Lc(n,o-8,BigInt(this.length*8),s),this.process(n,0);let a=mr(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=c/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<l;u++)a.setUint32(4*u,f[u],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:s,destroyed:i,pos:a}=this;return t.destroyed=i,t.finished=s,t.length=o,t.pos=a,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}},Ut=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var rt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var yr=BigInt(4294967295),Is=BigInt(32);function Oc(e,t=!1){return t?{h:Number(e&yr),l:Number(e>>Is&yr)}:{h:Number(e>>Is&yr)|0,l:Number(e&yr)|0}}function Bs(e,t=!1){let r=e.length,n=new Uint32Array(r),o=new Uint32Array(r);for(let s=0;s<r;s++){let{h:i,l:a}=Oc(e[s],t);[n[s],o[s]]=[i,a]}return[n,o]}var Un=(e,t,r)=>e>>>r,Rn=(e,t,r)=>e<<32-r|t>>>r,te=(e,t,r)=>e>>>r|t<<32-r,ee=(e,t,r)=>e<<32-r|t>>>r,je=(e,t,r)=>e<<64-r|t>>>r-32,$e=(e,t,r)=>e>>>r-32|t<<64-r;function Bt(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}var _s=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),Cs=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,Ts=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),Ds=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,Ps=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),Ls=(e,t,r,n,o,s)=>t+r+n+o+s+(e/2**32|0)|0;var Rc=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Gt=new Uint32Array(64),br=class extends Ge{constructor(t=32){super(64,t,8,!1),this.A=Ut[0]|0,this.B=Ut[1]|0,this.C=Ut[2]|0,this.D=Ut[3]|0,this.E=Ut[4]|0,this.F=Ut[5]|0,this.G=Ut[6]|0,this.H=Ut[7]|0}get(){let{A:t,B:r,C:n,D:o,E:s,F:i,G:a,H:c}=this;return[t,r,n,o,s,i,a,c]}set(t,r,n,o,s,i,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=a|0,this.H=c|0}process(t,r){for(let u=0;u<16;u++,r+=4)Gt[u]=t.getUint32(r,!1);for(let u=16;u<64;u++){let g=Gt[u-15],b=Gt[u-2],S=St(g,7)^St(g,18)^g>>>3,E=St(b,17)^St(b,19)^b>>>10;Gt[u]=E+Gt[u-7]+S+Gt[u-16]|0}let{A:n,B:o,C:s,D:i,E:a,F:c,G:l,H:f}=this;for(let u=0;u<64;u++){let g=St(a,6)^St(a,11)^St(a,25),b=f+g+vs(a,c,l)+Rc[u]+Gt[u]|0,E=(St(n,2)^St(n,13)^St(n,22))+As(n,o,s)|0;f=l,l=c,c=a,a=i+b|0,i=s,s=o,o=n,n=b+E|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(n,o,s,i,a,c,l,f)}roundClean(){Ot(Gt)}destroy(){this.set(0,0,0,0,0,0,0,0),Ot(this.buffer)}};var Os=Bs(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Kc=Os[0],Nc=Os[1],jt=new Uint32Array(80),$t=new Uint32Array(80),Kn=class extends Ge{constructor(t=64){super(128,t,16,!1),this.Ah=rt[0]|0,this.Al=rt[1]|0,this.Bh=rt[2]|0,this.Bl=rt[3]|0,this.Ch=rt[4]|0,this.Cl=rt[5]|0,this.Dh=rt[6]|0,this.Dl=rt[7]|0,this.Eh=rt[8]|0,this.El=rt[9]|0,this.Fh=rt[10]|0,this.Fl=rt[11]|0,this.Gh=rt[12]|0,this.Gl=rt[13]|0,this.Hh=rt[14]|0,this.Hl=rt[15]|0}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:s,Cl:i,Dh:a,Dl:c,Eh:l,El:f,Fh:u,Fl:g,Gh:b,Gl:S,Hh:E,Hl:m}=this;return[t,r,n,o,s,i,a,c,l,f,u,g,b,S,E,m]}set(t,r,n,o,s,i,a,c,l,f,u,g,b,S,E,m){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=f|0,this.Fh=u|0,this.Fl=g|0,this.Gh=b|0,this.Gl=S|0,this.Hh=E|0,this.Hl=m|0}process(t,r){for(let I=0;I<16;I++,r+=4)jt[I]=t.getUint32(r),$t[I]=t.getUint32(r+=4);for(let I=16;I<80;I++){let L=jt[I-15]|0,p=$t[I-15]|0,P=te(L,p,1)^te(L,p,8)^Un(L,p,7),D=ee(L,p,1)^ee(L,p,8)^Rn(L,p,7),B=jt[I-2]|0,h=$t[I-2]|0,x=te(B,h,19)^je(B,h,61)^Un(B,h,6),d=ee(B,h,19)^$e(B,h,61)^Rn(B,h,6),y=Ts(D,d,$t[I-7],$t[I-16]),w=Ds(y,P,x,jt[I-7],jt[I-16]);jt[I]=w|0,$t[I]=y|0}let{Ah:n,Al:o,Bh:s,Bl:i,Ch:a,Cl:c,Dh:l,Dl:f,Eh:u,El:g,Fh:b,Fl:S,Gh:E,Gl:m,Hh:v,Hl:T}=this;for(let I=0;I<80;I++){let L=te(u,g,14)^te(u,g,18)^je(u,g,41),p=ee(u,g,14)^ee(u,g,18)^$e(u,g,41),P=u&b^~u&E,D=g&S^~g&m,B=Ps(T,p,D,Nc[I],$t[I]),h=Ls(B,v,L,P,Kc[I],jt[I]),x=B|0,d=te(n,o,28)^je(n,o,34)^je(n,o,39),y=ee(n,o,28)^$e(n,o,34)^$e(n,o,39),w=n&s^n&a^s&a,_=o&i^o&c^i&c;v=E|0,T=m|0,E=b|0,m=S|0,b=u|0,S=g|0,{h:u,l:g}=Bt(l|0,f|0,h|0,x|0),l=a|0,f=c|0,a=s|0,c=i|0,s=n|0,i=o|0;let A=_s(x,y,_);n=Cs(A,h,d,w),o=A|0}({h:n,l:o}=Bt(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:i}=Bt(this.Bh|0,this.Bl|0,s|0,i|0),{h:a,l:c}=Bt(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:f}=Bt(this.Dh|0,this.Dl|0,l|0,f|0),{h:u,l:g}=Bt(this.Eh|0,this.El|0,u|0,g|0),{h:b,l:S}=Bt(this.Fh|0,this.Fl|0,b|0,S|0),{h:E,l:m}=Bt(this.Gh|0,this.Gl|0,E|0,m|0),{h:v,l:T}=Bt(this.Hh|0,this.Hl|0,v|0,T|0),this.set(n,o,s,i,a,c,l,f,u,g,b,S,E,m,v,T)}roundClean(){Ot(jt,$t)}destroy(){Ot(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var gr=On(()=>new br);var Us=On(()=>new Kn);var Mn=BigInt(0),kn=BigInt(1);function Rt(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}function Ze(e){let t=e.toString(16);return t.length&1?"0"+t:t}function Rs(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Mn:BigInt("0x"+e)}function Se(e){return Rs(It(e))}function re(e){return st(e),Rs(It(Uint8Array.from(e).reverse()))}function xr(e,t){return Ee(e.toString(16).padStart(t*2,"0"))}function ve(e,t){return xr(e,t).reverse()}function q(e,t,r){let n;if(typeof t=="string")try{n=Ee(t)}catch(s){throw new Error(e+" must be hex string or Uint8Array, cause: "+s)}else if(xe(t))n=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let o=n.length;if(typeof r=="number"&&o!==r)throw new Error(e+" of length "+r+" expected, got "+o);return n}var Nn=e=>typeof e=="bigint"&&Mn<=e;function Ks(e,t,r){return Nn(e)&&Nn(t)&&Nn(r)&&t<=e&&e<r}function Zt(e,t,r,n){if(!Ks(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function Ns(e){let t;for(t=0;e>Mn;e>>=kn,t+=1);return t}var ne=e=>(kn<<BigInt(e))-kn;function ks(e,t,r){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=b=>new Uint8Array(b),o=b=>Uint8Array.of(b),s=n(e),i=n(e),a=0,c=()=>{s.fill(1),i.fill(0),a=0},l=(...b)=>r(i,s,...b),f=(b=n(0))=>{i=l(o(0),b),s=l(),b.length!==0&&(i=l(o(1),b),s=l())},u=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let b=0,S=[];for(;b<t;){s=l();let E=s.slice();S.push(E),b+=s.length}return mt(...S)};return(b,S)=>{c(),f(b);let E;for(;!(E=S(u()));)f();return c(),E}}function Wt(e,t,r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(o,s,i){let a=e[o];if(i&&a===void 0)return;let c=typeof a;if(c!==s||a===null)throw new Error(`param "${o}" is invalid: expected ${s}, got ${c}`)}Object.entries(t).forEach(([o,s])=>n(o,s,!1)),Object.entries(r).forEach(([o,s])=>n(o,s,!0))}function Ae(e){let t=new WeakMap;return(r,...n)=>{let o=t.get(r);if(o!==void 0)return o;let s=e(r,...n);return t.set(r,s),s}}var ut=BigInt(0),Q=BigInt(1),oe=BigInt(2),kc=BigInt(3),qs=BigInt(4),Vs=BigInt(5),zs=BigInt(8);function F(e,t){let r=e%t;return r>=ut?r:t+r}function V(e,t,r){let n=e;for(;t-- >ut;)n*=n,n%=r;return n}function Ms(e,t){if(e===ut)throw new Error("invert: expected non-zero number");if(t<=ut)throw new Error("invert: expected positive modulus, got "+t);let r=F(e,t),n=t,o=ut,s=Q,i=Q,a=ut;for(;r!==ut;){let l=n/r,f=n%r,u=o-i*l,g=s-a*l;n=r,r=f,o=i,s=a,i=u,a=g}if(n!==Q)throw new Error("invert: does not exist");return F(o,t)}function Fs(e,t){let r=(e.ORDER+Q)/qs,n=e.pow(t,r);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}function Mc(e,t){let r=(e.ORDER-Vs)/zs,n=e.mul(t,oe),o=e.pow(n,r),s=e.mul(t,o),i=e.mul(e.mul(s,oe),o),a=e.mul(s,e.sub(i,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function Hc(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-Q,r=0;for(;t%oe===ut;)t/=oe,r++;let n=oe,o=vt(e);for(;Hs(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return Fs;let s=o.pow(n,t),i=(t+Q)/oe;return function(c,l){if(c.is0(l))return l;if(Hs(c,l)!==1)throw new Error("Cannot find square root");let f=r,u=c.mul(c.ONE,s),g=c.pow(l,t),b=c.pow(l,i);for(;!c.eql(g,c.ONE);){if(c.is0(g))return c.ZERO;let S=1,E=c.sqr(g);for(;!c.eql(E,c.ONE);)if(S++,E=c.sqr(E),S===f)throw new Error("Cannot find square root");let m=Q<<BigInt(f-S-1),v=c.pow(u,m);f=S,u=c.sqr(v),g=c.mul(g,u),b=c.mul(b,v)}return b}}function qc(e){return e%qs===kc?Fs:e%zs===Vs?Mc:Hc(e)}var Gs=(e,t)=>(F(e,t)&Q)===Q,Vc=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Hn(e){let t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},r=Vc.reduce((n,o)=>(n[o]="function",n),t);return Wt(e,r),e}function zc(e,t,r){if(r<ut)throw new Error("invalid exponent, negatives unsupported");if(r===ut)return e.ONE;if(r===Q)return t;let n=e.ONE,o=t;for(;r>ut;)r&Q&&(n=e.mul(n,o)),o=e.sqr(o),r>>=Q;return n}function We(e,t,r=!1){let n=new Array(t.length).fill(r?e.ZERO:void 0),o=t.reduce((i,a,c)=>e.is0(a)?i:(n[c]=i,e.mul(i,a)),e.ONE),s=e.inv(o);return t.reduceRight((i,a,c)=>e.is0(a)?i:(n[c]=e.mul(i,n[c]),e.mul(i,a)),s),n}function Hs(e,t){let r=(e.ORDER-Q)/oe,n=e.pow(t,r),o=e.eql(n,e.ONE),s=e.eql(n,e.ZERO),i=e.eql(n,e.neg(e.ONE));if(!o&&!s&&!i)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function js(e,t){t!==void 0&&Ve(t);let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function vt(e,t,r=!1,n={}){if(e<=ut)throw new Error("invalid field: expected ORDER > 0, got "+e);let o,s;if(typeof t=="object"&&t!=null){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");let f=t;f.BITS&&(o=f.BITS),f.sqrt&&(s=f.sqrt),typeof f.isLE=="boolean"&&(r=f.isLE)}else typeof t=="number"&&(o=t),n.sqrt&&(s=n.sqrt);let{nBitLength:i,nByteLength:a}=js(e,o);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c,l=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:a,MASK:ne(i),ZERO:ut,ONE:Q,create:f=>F(f,e),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return ut<=f&&f<e},is0:f=>f===ut,isValidNot0:f=>!l.is0(f)&&l.isValid(f),isOdd:f=>(f&Q)===Q,neg:f=>F(-f,e),eql:(f,u)=>f===u,sqr:f=>F(f*f,e),add:(f,u)=>F(f+u,e),sub:(f,u)=>F(f-u,e),mul:(f,u)=>F(f*u,e),pow:(f,u)=>zc(l,f,u),div:(f,u)=>F(f*Ms(u,e),e),sqrN:f=>f*f,addN:(f,u)=>f+u,subN:(f,u)=>f-u,mulN:(f,u)=>f*u,inv:f=>Ms(f,e),sqrt:s||(f=>(c||(c=qc(e)),c(l,f))),toBytes:f=>r?ve(f,a):xr(f,a),fromBytes:f=>{if(f.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+f.length);return r?re(f):Se(f)},invertBatch:f=>We(l,f),cmov:(f,u,g)=>g?u:f});return Object.freeze(l)}function $s(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function qn(e){let t=$s(e);return t+Math.ceil(t/2)}function Zs(e,t,r=!1){let n=e.length,o=$s(t),s=qn(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let i=r?re(e):Se(e),a=F(i,t-Q)+Q;return r?ve(a,o):xr(a,o)}var Be=BigInt(0),se=BigInt(1);function Ie(e,t){let r=t.negate();return e?r:t}function wr(e,t,r){let n=t==="pz"?i=>i.pz:i=>i.ez,o=We(e.Fp,r.map(n));return r.map((i,a)=>i.toAffine(o[a])).map(e.fromAffine)}function Js(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Vn(e,t){Js(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1),o=2**e,s=ne(e),i=BigInt(e);return{windows:r,windowSize:n,mask:s,maxNumber:o,shiftBy:i}}function Ws(e,t,r){let{windowSize:n,mask:o,maxNumber:s,shiftBy:i}=r,a=Number(e&o),c=e>>i;a>n&&(a-=s,c+=se);let l=t*n,f=l+Math.abs(a)-1,u=a===0,g=a<0,b=t%2!==0;return{nextN:c,offset:f,isZero:u,isNeg:g,isNegF:b,offsetF:l}}function Fc(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function Gc(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}var zn=new WeakMap,Qs=new WeakMap;function Fn(e){return Qs.get(e)||1}function Ys(e){if(e!==Be)throw new Error("invalid wNAF")}function Er(e,t){return{constTimeNegate:Ie,hasPrecomputes(r){return Fn(r)!==1},unsafeLadder(r,n,o=e.ZERO){let s=r;for(;n>Be;)n&se&&(o=o.add(s)),s=s.double(),n>>=se;return o},precomputeWindow(r,n){let{windows:o,windowSize:s}=Vn(n,t),i=[],a=r,c=a;for(let l=0;l<o;l++){c=a,i.push(c);for(let f=1;f<s;f++)c=c.add(a),i.push(c);a=c.double()}return i},wNAF(r,n,o){let s=e.ZERO,i=e.BASE,a=Vn(r,t);for(let c=0;c<a.windows;c++){let{nextN:l,offset:f,isZero:u,isNeg:g,isNegF:b,offsetF:S}=Ws(o,c,a);o=l,u?i=i.add(Ie(b,n[S])):s=s.add(Ie(g,n[f]))}return Ys(o),{p:s,f:i}},wNAFUnsafe(r,n,o,s=e.ZERO){let i=Vn(r,t);for(let a=0;a<i.windows&&o!==Be;a++){let{nextN:c,offset:l,isZero:f,isNeg:u}=Ws(o,a,i);if(o=c,!f){let g=n[l];s=s.add(u?g.negate():g)}}return Ys(o),s},getPrecomputes(r,n,o){let s=zn.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&(typeof o=="function"&&(s=o(s)),zn.set(n,s))),s},wNAFCached(r,n,o){let s=Fn(r);return this.wNAF(s,this.getPrecomputes(s,r,o),n)},wNAFCachedUnsafe(r,n,o,s){let i=Fn(r);return i===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(i,this.getPrecomputes(i,r,o),n,s)},setWindowSize(r,n){Js(n,t),Qs.set(r,n),zn.delete(r)}}}function ti(e,t,r,n){let o=t,s=e.ZERO,i=e.ZERO;for(;r>Be||n>Be;)r&se&&(s=s.add(o)),n&se&&(i=i.add(o)),o=o.double(),r>>=se,n>>=se;return{p1:s,p2:i}}function Sr(e,t,r,n){Fc(r,e),Gc(n,t);let o=r.length,s=n.length;if(o!==s)throw new Error("arrays of points and scalars must have equal length");let i=e.ZERO,a=Ns(BigInt(o)),c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);let l=ne(c),f=new Array(Number(l)+1).fill(i),u=Math.floor((t.BITS-1)/c)*c,g=i;for(let b=u;b>=0;b-=c){f.fill(i);for(let E=0;E<s;E++){let m=n[E],v=Number(m>>BigInt(b)&l);f[v]=f[v].add(r[E])}let S=i;for(let E=f.length-1,m=i;E>0;E--)m=m.add(f[E]),S=S.add(m);if(g=g.add(S),b!==0)for(let E=0;E<c;E++)g=g.double()}return g}function Xs(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Hn(t),t}else return vt(e)}function vr(e,t,r={}){if(!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let a of["p","n","h"]){let c=t[a];if(!(typeof c=="bigint"&&c>Be))throw new Error(`CURVE.${a} must be positive bigint`)}let n=Xs(t.p,r.Fp),o=Xs(t.n,r.Fn),i=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let a of i)if(!n.isValid(t[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:o}}var _t=BigInt(0),lt=BigInt(1),Gn=BigInt(2),jc=BigInt(8),$c={zip215:!0};function Zc(e,t,r,n){let o=e.sqr(r),s=e.sqr(n),i=e.add(e.mul(t.a,o),s),a=e.add(e.ONE,e.mul(t.d,e.mul(o,s)));return e.eql(i,a)}function Wc(e,t={}){let{Fp:r,Fn:n}=vr("edwards",e,t),{h:o,n:s}=e;Wt(t,{},{uvRatio:"function"});let i=Gn<<BigInt(n.BYTES*8)-lt,a=E=>r.create(E),c=t.uvRatio||((E,m)=>{try{return{isValid:!0,value:r.sqrt(r.div(E,m))}}catch{return{isValid:!1,value:_t}}});if(!Zc(r,e,e.Gx,e.Gy))throw new Error("bad curve params: generator point");function l(E,m,v=!1){let T=v?lt:_t;return Zt("coordinate "+E,m,T,i),m}function f(E){if(!(E instanceof b))throw new Error("ExtendedPoint expected")}let u=Ae((E,m)=>{let{ex:v,ey:T,ez:I}=E,L=E.is0();m==null&&(m=L?jc:r.inv(I));let p=a(v*m),P=a(T*m),D=a(I*m);if(L)return{x:_t,y:lt};if(D!==lt)throw new Error("invZ was invalid");return{x:p,y:P}}),g=Ae(E=>{let{a:m,d:v}=e;if(E.is0())throw new Error("bad point: ZERO");let{ex:T,ey:I,ez:L,et:p}=E,P=a(T*T),D=a(I*I),B=a(L*L),h=a(B*B),x=a(P*m),d=a(B*a(x+D)),y=a(h+a(v*a(P*D)));if(d!==y)throw new Error("bad point: equation left != right (1)");let w=a(T*I),_=a(L*p);if(w!==_)throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(m,v,T,I){this.ex=l("x",m),this.ey=l("y",v),this.ez=l("z",T,!0),this.et=l("t",I),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(m){if(m instanceof b)throw new Error("extended point not allowed");let{x:v,y:T}=m||{};return l("x",v),l("y",T),new b(v,T,lt,a(v*T))}static normalizeZ(m){return wr(b,"ez",m)}static msm(m,v){return Sr(b,n,m,v)}_setWindowSize(m){this.precompute(m)}precompute(m=8,v=!0){return S.setWindowSize(this,m),v||this.multiply(Gn),this}assertValidity(){g(this)}equals(m){f(m);let{ex:v,ey:T,ez:I}=this,{ex:L,ey:p,ez:P}=m,D=a(v*P),B=a(L*I),h=a(T*P),x=a(p*I);return D===B&&h===x}is0(){return this.equals(b.ZERO)}negate(){return new b(a(-this.ex),this.ey,this.ez,a(-this.et))}double(){let{a:m}=e,{ex:v,ey:T,ez:I}=this,L=a(v*v),p=a(T*T),P=a(Gn*a(I*I)),D=a(m*L),B=v+T,h=a(a(B*B)-L-p),x=D+p,d=x-P,y=D-p,w=a(h*d),_=a(x*y),A=a(h*y),C=a(d*x);return new b(w,_,C,A)}add(m){f(m);let{a:v,d:T}=e,{ex:I,ey:L,ez:p,et:P}=this,{ex:D,ey:B,ez:h,et:x}=m,d=a(I*D),y=a(L*B),w=a(P*T*x),_=a(p*h),A=a((I+L)*(D+B)-d-y),C=_-w,U=_+w,O=a(y-v*d),j=a(A*C),M=a(U*O),R=a(A*O),Z=a(C*U);return new b(j,M,Z,R)}subtract(m){return this.add(m.negate())}multiply(m){let v=m;Zt("scalar",v,lt,s);let{p:T,f:I}=S.wNAFCached(this,v,b.normalizeZ);return b.normalizeZ([T,I])[0]}multiplyUnsafe(m,v=b.ZERO){let T=m;return Zt("scalar",T,_t,s),T===_t?b.ZERO:this.is0()||T===lt?this:S.wNAFCachedUnsafe(this,T,b.normalizeZ,v)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}isTorsionFree(){return S.wNAFCachedUnsafe(this,s).is0()}toAffine(m){return u(this,m)}clearCofactor(){return o===lt?this:this.multiplyUnsafe(o)}static fromBytes(m,v=!1){return st(m),this.fromHex(m,v)}static fromHex(m,v=!1){let{d:T,a:I}=e,L=r.BYTES;m=q("pointHex",m,L),Rt("zip215",v);let p=m.slice(),P=m[L-1];p[L-1]=P&-129;let D=re(p),B=v?i:r.ORDER;Zt("pointHex.y",D,_t,B);let h=a(D*D),x=a(h-lt),d=a(T*h-I),{isValid:y,value:w}=c(x,d);if(!y)throw new Error("Point.fromHex: invalid y coordinate");let _=(w&lt)===lt,A=(P&128)!==0;if(!v&&w===_t&&A)throw new Error("Point.fromHex: x=0 and x_0=1");return A!==_&&(w=a(-w)),b.fromAffine({x:w,y:D})}static fromPrivateScalar(m){return b.BASE.multiply(m)}toBytes(){let{x:m,y:v}=this.toAffine(),T=ve(v,r.BYTES);return T[T.length-1]|=m&lt?128:0,T}toRawBytes(){return this.toBytes()}toHex(){return It(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}b.BASE=new b(e.Gx,e.Gy,lt,a(e.Gx*e.Gy)),b.ZERO=new b(_t,lt,lt,_t),b.Fp=r,b.Fn=n;let S=Er(b,n.BYTES*8);return b}function Yc(e,t){Wt(t,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:r,hash:n}=t,{BASE:o,Fp:s,Fn:i}=e,a=i.ORDER,c=t.randomBytes||Fe,l=t.adjustScalarBytes||(p=>p),f=t.domain||((p,P,D)=>{if(Rt("phflag",D),P.length||D)throw new Error("Contexts/pre-hash are not supported");return p});function u(p){return i.create(p)}function g(p){return u(re(p))}function b(p){let P=s.BYTES;p=q("private key",p,P);let D=q("hashed private key",n(p),2*P),B=l(D.slice(0,P)),h=D.slice(P,2*P),x=g(B);return{head:B,prefix:h,scalar:x}}function S(p){let{head:P,prefix:D,scalar:B}=b(p),h=o.multiply(B),x=h.toBytes();return{head:P,prefix:D,scalar:B,point:h,pointBytes:x}}function E(p){return S(p).pointBytes}function m(p=Uint8Array.of(),...P){let D=mt(...P);return g(n(f(D,q("context",p),!!r)))}function v(p,P,D={}){p=q("message",p),r&&(p=r(p));let{prefix:B,scalar:h,pointBytes:x}=S(P),d=m(D.context,B,p),y=o.multiply(d).toBytes(),w=m(D.context,y,x,p),_=u(d+w*h);Zt("signature.s",_,_t,a);let A=s.BYTES,C=mt(y,ve(_,A));return q("result",C,A*2)}let T=$c;function I(p,P,D,B=T){let{context:h,zip215:x}=B,d=s.BYTES;p=q("signature",p,2*d),P=q("message",P),D=q("publicKey",D,d),x!==void 0&&Rt("zip215",x),r&&(P=r(P));let y=re(p.slice(d,2*d)),w,_,A;try{w=e.fromHex(D,x),_=e.fromHex(p.slice(0,d),x),A=o.multiplyUnsafe(y)}catch{return!1}if(!x&&w.isSmallOrder())return!1;let C=m(h,_.toBytes(),w.toBytes(),P);return _.add(w.multiplyUnsafe(C)).subtract(A).clearCofactor().is0()}return o.precompute(8),{getPublicKey:E,sign:v,verify:I,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>c(s.BYTES),precompute(p=8,P=e.BASE){return P.precompute(p,!1)}},Point:e}}function Xc(e){let t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=vt(t.n,e.nBitLength,!0),o={Fp:r,Fn:n,uvRatio:e.uvRatio},s={hash:e.hash,randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:o,eddsaOpts:s}}function Jc(e,t){return Object.assign({},t,{ExtendedPoint:t.Point,CURVE:e})}function ei(e){let{CURVE:t,curveOpts:r,eddsaOpts:n}=Xc(e),o=Wc(t,r),s=Yc(o,n);return Jc(e,s)}var Vh=BigInt(0),Qc=BigInt(1),ri=BigInt(2),zh=BigInt(3),tf=BigInt(5),ef=BigInt(8),Ar={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:ef,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function rf(e){let t=BigInt(10),r=BigInt(20),n=BigInt(40),o=BigInt(80),s=Ar.p,a=e*e%s*e%s,c=V(a,ri,s)*a%s,l=V(c,Qc,s)*e%s,f=V(l,tf,s)*l%s,u=V(f,t,s)*f%s,g=V(u,r,s)*u%s,b=V(g,n,s)*g%s,S=V(b,o,s)*b%s,E=V(S,o,s)*b%s,m=V(E,t,s)*f%s;return{pow_p_5_8:V(m,ri,s)*e%s,b2:a}}function nf(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var ni=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function of(e,t){let r=Ar.p,n=F(t*t*t,r),o=F(n*n*t,r),s=rf(e*o).pow_p_5_8,i=F(e*n*s,r),a=F(t*i*i,r),c=i,l=F(i*ni,r),f=a===e,u=a===F(-e,r),g=a===F(-e*ni,r);return f&&(i=c),(u||g)&&(i=l),Gs(i,r)&&(i=F(-i,r)),{isValid:f||u,value:i}}var sf=vt(Ar.p,void 0,!0),af={...Ar,Fp:sf,hash:Us,adjustScalarBytes:nf,uvRatio:of},oi=ei(af);var Ye=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},Ir=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var si={get(e=globalThis){let t=e.crypto;if(t?.subtle==null)throw new Ir("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var gt=si;var Br=32;var jn,cf=(async()=>{try{return await gt.get().subtle.generateKey({name:"Ed25519"},!0,["sign","verify"]),!0}catch{return!1}})();async function ff(e,t,r){if(e.buffer instanceof ArrayBuffer){let n=await gt.get().subtle.importKey("raw",e.buffer,{name:"Ed25519"},!1,["verify"]);return await gt.get().subtle.verify({name:"Ed25519"},n,t,r instanceof Uint8Array?r:r.subarray())}throw new TypeError("WebCrypto does not support SharedArrayBuffer for Ed25519 keys")}function uf(e,t,r){return oi.verify(t,r instanceof Uint8Array?r:r.subarray(),e)}async function ii(e,t,r){return jn==null&&(jn=await cf),jn?ff(e,t,r):uf(e,t,r)}function _r(e){return e==null?!1:typeof e.then=="function"&&typeof e.catch=="function"&&typeof e.finally=="function"}var Cr=class{type="Ed25519";raw;constructor(t){this.raw=$n(t,Br)}toMultihash(){return Et.digest(Ft(this))}toCID(){return W.createV1(114,this.toMultihash())}toString(){return z.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:J(this.raw,t.raw)}verify(t,r,n){n?.signal?.throwIfAborted();let o=ii(this.raw,r,t);return _r(o)?o.then(s=>(n?.signal?.throwIfAborted(),s)):o}};function Zn(e){return e=$n(e,Br),new Cr(e)}function $n(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new Y(`Key must be a Uint8Array of length ${t}, got ${e.length}`);return e}var hf=Math.pow(2,7),df=Math.pow(2,14),pf=Math.pow(2,21),Wn=Math.pow(2,28),Yn=Math.pow(2,35),Xn=Math.pow(2,42),Jn=Math.pow(2,49),k=128,it=127;function xt(e){if(e<hf)return 1;if(e<df)return 2;if(e<pf)return 3;if(e<Wn)return 4;if(e<Yn)return 5;if(e<Xn)return 6;if(e<Jn)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function _e(e,t,r=0){switch(xt(e)){case 8:t[r++]=e&255|k,e/=128;case 7:t[r++]=e&255|k,e/=128;case 6:t[r++]=e&255|k,e/=128;case 5:t[r++]=e&255|k,e/=128;case 4:t[r++]=e&255|k,e>>>=7;case 3:t[r++]=e&255|k,e>>>=7;case 2:t[r++]=e&255|k,e>>>=7;case 1:{t[r++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return t}function mf(e,t,r=0){switch(xt(e)){case 8:t.set(r++,e&255|k),e/=128;case 7:t.set(r++,e&255|k),e/=128;case 6:t.set(r++,e&255|k),e/=128;case 5:t.set(r++,e&255|k),e/=128;case 4:t.set(r++,e&255|k),e>>>=7;case 3:t.set(r++,e&255|k),e>>>=7;case 2:t.set(r++,e&255|k),e>>>=7;case 1:{t.set(r++,e&255),e>>>=7;break}default:throw new Error("unreachable")}return t}function Qn(e,t){let r=e[t],n=0;if(n+=r&it,r<k||(r=e[t+1],n+=(r&it)<<7,r<k)||(r=e[t+2],n+=(r&it)<<14,r<k)||(r=e[t+3],n+=(r&it)<<21,r<k)||(r=e[t+4],n+=(r&it)*Wn,r<k)||(r=e[t+5],n+=(r&it)*Yn,r<k)||(r=e[t+6],n+=(r&it)*Xn,r<k)||(r=e[t+7],n+=(r&it)*Jn,r<k))return n;throw new RangeError("Could not decode varint")}function yf(e,t){let r=e.get(t),n=0;if(n+=r&it,r<k||(r=e.get(t+1),n+=(r&it)<<7,r<k)||(r=e.get(t+2),n+=(r&it)<<14,r<k)||(r=e.get(t+3),n+=(r&it)<<21,r<k)||(r=e.get(t+4),n+=(r&it)*Wn,r<k)||(r=e.get(t+5),n+=(r&it)*Yn,r<k)||(r=e.get(t+6),n+=(r&it)*Xn,r<k)||(r=e.get(t+7),n+=(r&it)*Jn,r<k))return n;throw new RangeError("Could not decode varint")}function Tr(e,t,r=0){return t==null&&(t=dt(xt(e))),t instanceof Uint8Array?_e(e,t,r):mf(e,t,r)}function to(e,t=0){return e instanceof Uint8Array?Qn(e,t):yf(e,t)}var eo=new Float32Array([-0]),Yt=new Uint8Array(eo.buffer);function fi(e,t,r){eo[0]=e,t[r]=Yt[0],t[r+1]=Yt[1],t[r+2]=Yt[2],t[r+3]=Yt[3]}function ui(e,t){return Yt[0]=e[t],Yt[1]=e[t+1],Yt[2]=e[t+2],Yt[3]=e[t+3],eo[0]}var ro=new Float64Array([-0]),at=new Uint8Array(ro.buffer);function li(e,t,r){ro[0]=e,t[r]=at[0],t[r+1]=at[1],t[r+2]=at[2],t[r+3]=at[3],t[r+4]=at[4],t[r+5]=at[5],t[r+6]=at[6],t[r+7]=at[7]}function hi(e,t){return at[0]=e[t],at[1]=e[t+1],at[2]=e[t+2],at[3]=e[t+3],at[4]=e[t+4],at[5]=e[t+5],at[6]=e[t+6],at[7]=e[t+7],ro[0]}var bf=BigInt(Number.MAX_SAFE_INTEGER),gf=BigInt(Number.MIN_SAFE_INTEGER),yt=class e{lo;hi;constructor(t,r){this.lo=t|0,this.hi=r|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return ie;if(t<bf&&t>gf)return this.fromNumber(Number(t));let r=t<0n;r&&(t=-t);let n=t>>32n,o=t-(n<<32n);return r&&(n=~n|0n,o=~o|0n,++o>di&&(o=0n,++n>di&&(n=0n))),new e(Number(o),Number(n))}static fromNumber(t){if(t===0)return ie;let r=t<0;r&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return r&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new e(n,o)}static from(t){return typeof t=="number"?e.fromNumber(t):typeof t=="bigint"?e.fromBigInt(t):typeof t=="string"?e.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new e(t.low>>>0,t.high>>>0):ie}},ie=new yt(0,0);ie.toBigInt=function(){return 0n};ie.zzEncode=ie.zzDecode=function(){return this};ie.length=function(){return 1};var di=4294967296n;function pi(e){let t=0,r=0;for(let n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function mi(e,t,r){if(r-t<1)return"";let o,s=[],i=0,a;for(;t<r;)a=e[t++],a<128?s[i++]=a:a>191&&a<224?s[i++]=(a&31)<<6|e[t++]&63:a>239&&a<365?(a=((a&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[i++]=55296+(a>>10),s[i++]=56320+(a&1023)):s[i++]=(a&15)<<12|(e[t++]&63)<<6|e[t++]&63,i>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,s)),i=0);return o!=null?(i>0&&o.push(String.fromCharCode.apply(String,s.slice(0,i))),o.join("")):String.fromCharCode.apply(String,s.slice(0,i))}function no(e,t,r){let n=r,o,s;for(let i=0;i<e.length;++i)o=e.charCodeAt(i),o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(i+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++i,t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128);return r-n}function At(e,t){return RangeError(`index out of range: ${e.pos} + ${t??1} > ${e.len}`)}function Dr(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}var oo=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,At(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw At(this,4);return Dr(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw At(this,4);return Dr(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw At(this,4);let t=ui(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw At(this,4);let t=hi(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw At(this,t);return this.pos+=t,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let t=this.bytes();return mi(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw At(this,t);this.pos+=t}else do if(this.pos>=this.len)throw At(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new yt(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw At(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,t}if(this.len-this.pos>4){for(;r<5;++r)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;r<5;++r){if(this.pos>=this.len)throw At(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw At(this,8);let t=Dr(this.buf,this.pos+=4),r=Dr(this.buf,this.pos+=4);return new yt(t,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=Qn(this.buf,this.pos);return this.pos+=xt(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function so(e){return new oo(e instanceof Uint8Array?e:e.subarray())}function Kt(e,t,r){let n=so(e);return t.decode(n,void 0,r)}function io(e){let t=e??8192,r=t>>>1,n,o=t;return function(i){if(i<1||i>r)return dt(i);o+i>t&&(n=dt(t),o=0);let a=n.subarray(o,o+=i);return(o&7)!==0&&(o=(o|7)+1),a}}var ae=class{fn;len;next;val;constructor(t,r,n){this.fn=t,this.len=r,this.next=void 0,this.val=n}};function ao(){}var fo=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},xf=io();function wf(e){return globalThis.Buffer!=null?dt(e):xf(e)}var Je=class{len;head;tail;states;constructor(){this.len=0,this.head=new ae(ao,0,0),this.tail=this.head,this.states=null}_push(t,r,n){return this.tail=this.tail.next=new ae(t,r,n),this.len+=r,this}uint32(t){return this.len+=(this.tail=this.tail.next=new uo((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(Pr,10,yt.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let r=yt.fromBigInt(t);return this._push(Pr,r.length(),r)}uint64Number(t){return this._push(_e,xt(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let r=yt.fromBigInt(t).zzEncode();return this._push(Pr,r.length(),r)}sint64Number(t){let r=yt.fromNumber(t).zzEncode();return this._push(Pr,r.length(),r)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(co,1,t?1:0)}fixed32(t){return this._push(Xe,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let r=yt.fromBigInt(t);return this._push(Xe,4,r.lo)._push(Xe,4,r.hi)}fixed64Number(t){let r=yt.fromNumber(t);return this._push(Xe,4,r.lo)._push(Xe,4,r.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(fi,4,t)}double(t){return this._push(li,8,t)}bytes(t){let r=t.length>>>0;return r===0?this._push(co,1,0):this.uint32(r)._push(Sf,r,t)}string(t){let r=pi(t);return r!==0?this.uint32(r)._push(no,r,t):this._push(co,1,0)}fork(){return this.states=new fo(this),this.head=this.tail=new ae(ao,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new ae(ao,0,0),this.len=0),this}ldelim(){let t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=r,this.len+=n),this}finish(){let t=this.head.next,r=wf(this.len),n=0;for(;t!=null;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r}};function co(e,t,r){t[r]=e&255}function Ef(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}var uo=class extends ae{next;constructor(t,r){super(Ef,t,r),this.next=void 0}};function Pr(e,t,r){for(;e.hi!==0;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}function Xe(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Sf(e,t,r){t.set(e,r)}globalThis.Buffer!=null&&(Je.prototype.bytes=function(e){let t=e.length>>>0;return this.uint32(t),t>0&&this._push(vf,t,e),this},Je.prototype.string=function(e){let t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(Af,t,e),this});function vf(e,t,r){t.set(e,r)}function Af(e,t,r){e.length<40?no(e,t,r):t.utf8Write!=null?t.utf8Write(e,r):t.set(N(e),r)}function lo(){return new Je}function Nt(e,t){let r=lo();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var Ce;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(Ce||(Ce={}));function Lr(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function ho(e){function t(o){if(e[o.toString()]==null)throw new Error("Invalid enum value");return e[o]}let r=function(s,i){let a=t(s);i.int32(a)},n=function(s){let i=s.int32();return t(i)};return Lr("enum",Ce.VARINT,r,n)}function kt(e,t){return Lr("message",Ce.LENGTH_DELIMITED,e,t)}var Or=class extends Error{code="ERR_MAX_LENGTH";name="MaxLengthError"};var $;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.secp256k1="secp256k1",e.ECDSA="ECDSA"})($||($={}));var po;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.secp256k1=2]="secp256k1",e[e.ECDSA=3]="ECDSA"})(po||(po={}));(function(e){e.codec=()=>ho(po)})($||($={}));var Ct;(function(e){let t;e.codec=()=>(t==null&&(t=kt((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),$.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let a=r.uint32();switch(a>>>3){case 1:{s.Type=$.codec().decode(r);break}case 2:{s.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return s})),t),e.encode=r=>Nt(r,e.codec()),e.decode=(r,n)=>Kt(r,e.codec(),n)})(Ct||(Ct={}));var mo;(function(e){let t;e.codec=()=>(t==null&&(t=kt((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),$.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let a=r.uint32();switch(a>>>3){case 1:{s.Type=$.codec().decode(r);break}case 2:{s.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return s})),t),e.encode=r=>Nt(r,e.codec()),e.decode=(r,n)=>Kt(r,e.codec(),n)})(mo||(mo={}));var tr={};ht(tr,{MAX_RSA_KEY_SIZE:()=>yo,generateRSAKeyPair:()=>Ei,jwkToJWKKeyPair:()=>Si,jwkToPkcs1:()=>Cf,jwkToPkix:()=>wo,jwkToRSAPrivateKey:()=>Ao,pkcs1MessageToJwk:()=>go,pkcs1MessageToRSAPrivateKey:()=>Eo,pkcs1ToJwk:()=>_f,pkcs1ToRSAPrivateKey:()=>wi,pkixMessageToJwk:()=>xo,pkixMessageToRSAPublicKey:()=>vo,pkixToJwk:()=>Tf,pkixToRSAPublicKey:()=>So});var Ur=gr;var Te=class{type="RSA";jwk;_raw;_multihash;constructor(t,r){this.jwk=t,this._multihash=r}get raw(){return this._raw==null&&(this._raw=tr.jwkToPkix(this.jwk)),this._raw}toMultihash(){return this._multihash}toCID(){return W.createV1(114,this._multihash)}toString(){return z.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:J(this.raw,t.raw)}verify(t,r,n){return xi(this.jwk,r,t,n)}},Qe=class{type="RSA";jwk;_raw;publicKey;constructor(t,r){this.jwk=t,this.publicKey=r}get raw(){return this._raw==null&&(this._raw=tr.jwkToPkcs1(this.jwk)),this._raw}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:J(this.raw,t.raw)}sign(t,r){return gi(this.jwk,t,r)}};var yo=8192,bo=18,If=1062,Bf=Uint8Array.from([48,13,6,9,42,134,72,134,247,13,1,1,1,5,0]);function _f(e){let t=Pt(e);return go(t)}function go(e){return{n:K(e[1],"base64url"),e:K(e[2],"base64url"),d:K(e[3],"base64url"),p:K(e[4],"base64url"),q:K(e[5],"base64url"),dp:K(e[6],"base64url"),dq:K(e[7],"base64url"),qi:K(e[8],"base64url"),kty:"RSA"}}function Cf(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new Y("JWK was missing components");return zt([pt(Uint8Array.from([0])),pt(N(e.n,"base64url")),pt(N(e.e,"base64url")),pt(N(e.d,"base64url")),pt(N(e.p,"base64url")),pt(N(e.q,"base64url")),pt(N(e.dp,"base64url")),pt(N(e.dq,"base64url")),pt(N(e.qi,"base64url"))]).subarray()}function Tf(e){let t=Pt(e,{offset:0});return xo(t)}function xo(e){let t=Pt(e[1],{offset:0});return{kty:"RSA",n:K(t[0],"base64url"),e:K(t[1],"base64url")}}function wo(e){if(e.n==null||e.e==null)throw new Y("JWK was missing components");return zt([Bf,pr(zt([pt(N(e.n,"base64url")),pt(N(e.e,"base64url"))]))]).subarray()}function wi(e){let t=Pt(e);return Eo(t)}function Eo(e){let t=go(e);return Ao(t)}function So(e,t){if(e.byteLength>=If)throw new le("Key size is too large");let r=Pt(e,{offset:0});return vo(r,e,t)}function vo(e,t,r){let n=xo(e);if(r==null){let o=Ur(Ct.encode({Type:$.RSA,Data:t}));r=wt(bo,o)}return new Te(n,r)}function Ao(e){if(Ai(e)>yo)throw new Y("Key size is too large");let t=Si(e),r=Ur(Ct.encode({Type:$.RSA,Data:wo(t.publicKey)})),n=wt(bo,r);return new Qe(t.privateKey,new Te(t.publicKey,n))}async function Ei(e){if(e>yo)throw new Y("Key size is too large");let t=await vi(e),r=Ur(Ct.encode({Type:$.RSA,Data:wo(t.publicKey)})),n=wt(bo,r);return new Qe(t.privateKey,new Te(t.publicKey,n))}function Si(e){if(e==null)throw new Y("Missing key parameter");return{privateKey:e,publicKey:{kty:e.kty,n:e.n,e:e.e}}}async function vi(e,t){let r=await gt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]);t?.signal?.throwIfAborted();let n=await Df(r,t);return{privateKey:n[0],publicKey:n[1]}}async function gi(e,t,r){let n=await gt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]);r?.signal?.throwIfAborted();let o=await gt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},n,t instanceof Uint8Array?t:t.subarray());return r?.signal?.throwIfAborted(),new Uint8Array(o,0,o.byteLength)}async function xi(e,t,r,n){let o=await gt.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);n?.signal?.throwIfAborted();let s=await gt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},o,t,r instanceof Uint8Array?r:r.subarray());return n?.signal?.throwIfAborted(),s}async function Df(e,t){if(e.privateKey==null||e.publicKey==null)throw new Y("Private and public key are required");let r=await Promise.all([gt.get().subtle.exportKey("jwk",e.privateKey),gt.get().subtle.exportKey("jwk",e.publicKey)]);return t?.signal?.throwIfAborted(),r}function Ai(e){if(e.kty!=="RSA")throw new Y("invalid key type");if(e.n==null)throw new Y("invalid key modulus");return N(e.n,"base64url").length*8}var Rr=class extends ge{constructor(t,r){super(),this.finished=!1,this.destroyed=!1,xs(t);let n=ze(r);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?t.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=t.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),Ot(s)}update(t){return we(this),this.iHash.update(t),this}digestInto(t){we(this),st(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Io=(e,t,r)=>new Rr(e,t).update(r).digest();Io.create=(e,t)=>new Rr(e,t);function Ii(e){e.lowS!==void 0&&Rt("lowS",e.lowS),e.prehash!==void 0&&Rt("prehash",e.prehash)}var Bo=class extends Error{constructor(t=""){super(t)}},Mt={Err:Bo,_tlv:{encode:(e,t)=>{let{Err:r}=Mt;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let n=t.length/2,o=Ze(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");let s=n>127?Ze(o.length/2|128):"";return Ze(e)+s+o+t},decode(e,t){let{Err:r}=Mt,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let o=t[n++],s=!!(o&128),i=0;if(!s)i=o;else{let c=o&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");let l=t.subarray(n,n+c);if(l.length!==c)throw new r("tlv.decode: length bytes not complete");if(l[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let f of l)i=i<<8|f;if(n+=c,i<128)throw new r("tlv.decode(long): not minimal encoding")}let a=t.subarray(n,n+i);if(a.length!==i)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+i)}}},_int:{encode(e){let{Err:t}=Mt;if(e<er)throw new t("integer: negative integers are not allowed");let r=Ze(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=Mt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Se(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=Mt,o=q("signature",e),{v:s,l:i}=n.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=n.decode(2,s),{v:l,l:f}=n.decode(2,c);if(f.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){let{_tlv:t,_int:r}=Mt,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),s=n+o;return t.encode(48,s)}},er=BigInt(0),rr=BigInt(1),Pf=BigInt(2),Kr=BigInt(3),Lf=BigInt(4);function Of(e,t,r){function n(o){let s=e.sqr(o),i=e.mul(s,o);return e.add(e.add(i,e.mul(o,t)),r)}return n}function Bi(e,t,r){let{BYTES:n}=e;function o(s){let i;if(typeof s=="bigint")i=s;else{let a=q("private key",s);if(t){if(!t.includes(a.length*2))throw new Error("invalid private key");let c=new Uint8Array(n);c.set(a,c.length-a.length),a=c}try{i=e.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof s}`)}}if(r&&(i=e.create(i)),!e.isValidNot0(i))throw new Error("invalid private key: out of range [1..N-1]");return i}return o}function Uf(e,t={}){let{Fp:r,Fn:n}=vr("weierstrass",e,t),{h:o,n:s}=e;Wt(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:i}=t;if(i&&(!r.is0(e.a)||typeof i.beta!="bigint"||typeof i.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(B,h,x){let{x:d,y}=h.toAffine(),w=r.toBytes(d);if(Rt("isCompressed",x),x){a();let _=!r.isOdd(y);return mt(_i(_),w)}else return mt(Uint8Array.of(4),w,r.toBytes(y))}function l(B){st(B);let h=r.BYTES,x=h+1,d=2*h+1,y=B.length,w=B[0],_=B.subarray(1);if(y===x&&(w===2||w===3)){let A=r.fromBytes(_);if(!r.isValid(A))throw new Error("bad point: is not on curve, wrong x");let C=g(A),U;try{U=r.sqrt(C)}catch(M){let R=M instanceof Error?": "+M.message:"";throw new Error("bad point: is not on curve, sqrt error"+R)}a();let O=r.isOdd(U);return(w&1)===1!==O&&(U=r.neg(U)),{x:A,y:U}}else if(y===d&&w===4){let A=r.fromBytes(_.subarray(h*0,h*1)),C=r.fromBytes(_.subarray(h*1,h*2));if(!b(A,C))throw new Error("bad point: is not on curve");return{x:A,y:C}}else throw new Error(`bad point: got length ${y}, expected compressed=${x} or uncompressed=${d}`)}let f=t.toBytes||c,u=t.fromBytes||l,g=Of(r,e.a,e.b);function b(B,h){let x=r.sqr(h),d=g(B);return r.eql(x,d)}if(!b(e.Gx,e.Gy))throw new Error("bad curve params: generator point");let S=r.mul(r.pow(e.a,Kr),Lf),E=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(S,E)))throw new Error("bad curve params: a or b");function m(B,h,x=!1){if(!r.isValid(h)||x&&r.is0(h))throw new Error(`bad point coordinate ${B}`);return h}function v(B){if(!(B instanceof p))throw new Error("ProjectivePoint expected")}let T=Ae((B,h)=>{let{px:x,py:d,pz:y}=B;if(r.eql(y,r.ONE))return{x,y:d};let w=B.is0();h==null&&(h=w?r.ONE:r.inv(y));let _=r.mul(x,h),A=r.mul(d,h),C=r.mul(y,h);if(w)return{x:r.ZERO,y:r.ZERO};if(!r.eql(C,r.ONE))throw new Error("invZ was invalid");return{x:_,y:A}}),I=Ae(B=>{if(B.is0()){if(t.allowInfinityPoint&&!r.is0(B.py))return;throw new Error("bad point: ZERO")}let{x:h,y:x}=B.toAffine();if(!r.isValid(h)||!r.isValid(x))throw new Error("bad point: x or y not field elements");if(!b(h,x))throw new Error("bad point: equation left != right");if(!B.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function L(B,h,x,d,y){return x=new p(r.mul(x.px,B),x.py,x.pz),h=Ie(d,h),x=Ie(y,x),h.add(x)}class p{constructor(h,x,d){this.px=m("x",h),this.py=m("y",x,!0),this.pz=m("z",d),Object.freeze(this)}static fromAffine(h){let{x,y:d}=h||{};if(!h||!r.isValid(x)||!r.isValid(d))throw new Error("invalid affine point");if(h instanceof p)throw new Error("projective point not allowed");return r.is0(x)&&r.is0(d)?p.ZERO:new p(x,d,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(h){return wr(p,"pz",h)}static fromBytes(h){return st(h),p.fromHex(h)}static fromHex(h){let x=p.fromAffine(u(q("pointHex",h)));return x.assertValidity(),x}static fromPrivateKey(h){let x=Bi(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return p.BASE.multiply(x(h))}static msm(h,x){return Sr(p,n,h,x)}precompute(h=8,x=!0){return D.setWindowSize(this,h),x||this.multiply(Kr),this}_setWindowSize(h){this.precompute(h)}assertValidity(){I(this)}hasEvenY(){let{y:h}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(h)}equals(h){v(h);let{px:x,py:d,pz:y}=this,{px:w,py:_,pz:A}=h,C=r.eql(r.mul(x,A),r.mul(w,y)),U=r.eql(r.mul(d,A),r.mul(_,y));return C&&U}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){let{a:h,b:x}=e,d=r.mul(x,Kr),{px:y,py:w,pz:_}=this,A=r.ZERO,C=r.ZERO,U=r.ZERO,O=r.mul(y,y),j=r.mul(w,w),M=r.mul(_,_),R=r.mul(y,w);return R=r.add(R,R),U=r.mul(y,_),U=r.add(U,U),A=r.mul(h,U),C=r.mul(d,M),C=r.add(A,C),A=r.sub(j,C),C=r.add(j,C),C=r.mul(A,C),A=r.mul(R,A),U=r.mul(d,U),M=r.mul(h,M),R=r.sub(O,M),R=r.mul(h,R),R=r.add(R,U),U=r.add(O,O),O=r.add(U,O),O=r.add(O,M),O=r.mul(O,R),C=r.add(C,O),M=r.mul(w,_),M=r.add(M,M),O=r.mul(M,R),A=r.sub(A,O),U=r.mul(M,j),U=r.add(U,U),U=r.add(U,U),new p(A,C,U)}add(h){v(h);let{px:x,py:d,pz:y}=this,{px:w,py:_,pz:A}=h,C=r.ZERO,U=r.ZERO,O=r.ZERO,j=e.a,M=r.mul(e.b,Kr),R=r.mul(x,w),Z=r.mul(d,_),X=r.mul(y,A),ot=r.add(x,d),H=r.add(w,_);ot=r.mul(ot,H),H=r.add(R,Z),ot=r.sub(ot,H),H=r.add(x,y);let ct=r.add(w,A);return H=r.mul(H,ct),ct=r.add(R,X),H=r.sub(H,ct),ct=r.add(d,y),C=r.add(_,A),ct=r.mul(ct,C),C=r.add(Z,X),ct=r.sub(ct,C),O=r.mul(j,H),C=r.mul(M,X),O=r.add(C,O),C=r.sub(Z,O),O=r.add(Z,O),U=r.mul(C,O),Z=r.add(R,R),Z=r.add(Z,R),X=r.mul(j,X),H=r.mul(M,H),Z=r.add(Z,X),X=r.sub(R,X),X=r.mul(j,X),H=r.add(H,X),R=r.mul(Z,H),U=r.add(U,R),R=r.mul(ct,H),C=r.mul(ot,C),C=r.sub(C,R),R=r.mul(ot,Z),O=r.mul(ct,O),O=r.add(O,R),new p(C,U,O)}subtract(h){return this.add(h.negate())}is0(){return this.equals(p.ZERO)}multiply(h){let{endo:x}=t;if(!n.isValidNot0(h))throw new Error("invalid scalar: out of range");let d,y,w=_=>D.wNAFCached(this,_,p.normalizeZ);if(x){let{k1neg:_,k1:A,k2neg:C,k2:U}=x.splitScalar(h),{p:O,f:j}=w(A),{p:M,f:R}=w(U);y=j.add(R),d=L(x.beta,O,M,_,C)}else{let{p:_,f:A}=w(h);d=_,y=A}return p.normalizeZ([d,y])[0]}multiplyUnsafe(h){let{endo:x}=t,d=this;if(!n.isValid(h))throw new Error("invalid scalar: out of range");if(h===er||d.is0())return p.ZERO;if(h===rr)return d;if(D.hasPrecomputes(this))return this.multiply(h);if(x){let{k1neg:y,k1:w,k2neg:_,k2:A}=x.splitScalar(h),{p1:C,p2:U}=ti(p,d,w,A);return L(x.beta,C,U,y,_)}else return D.wNAFCachedUnsafe(d,h)}multiplyAndAddUnsafe(h,x,d){let y=this.multiplyUnsafe(x).add(h.multiplyUnsafe(d));return y.is0()?void 0:y}toAffine(h){return T(this,h)}isTorsionFree(){let{isTorsionFree:h}=t;return o===rr?!0:h?h(p,this):D.wNAFCachedUnsafe(this,s).is0()}clearCofactor(){let{clearCofactor:h}=t;return o===rr?this:h?h(p,this):this.multiplyUnsafe(o)}toBytes(h=!0){return Rt("isCompressed",h),this.assertValidity(),f(p,this,h)}toRawBytes(h=!0){return this.toBytes(h)}toHex(h=!0){return It(this.toBytes(h))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}p.BASE=new p(e.Gx,e.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO),p.Fp=r,p.Fn=n;let P=n.BITS,D=Er(p,t.endo?Math.ceil(P/2):P);return p}function _i(e){return Uint8Array.of(e?2:3)}function Rf(e,t,r={}){Wt(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let n=t.randomBytes||Fe,o=t.hmac||((d,...y)=>Io(t.hash,d,mt(...y))),{Fp:s,Fn:i}=e,{ORDER:a,BITS:c}=i;function l(d){let y=a>>rr;return d>y}function f(d){return l(d)?i.neg(d):d}function u(d,y){if(!i.isValidNot0(y))throw new Error(`invalid signature ${d}: out of range 1..CURVE.n`)}class g{constructor(y,w,_){u("r",y),u("s",w),this.r=y,this.s=w,_!=null&&(this.recovery=_),Object.freeze(this)}static fromCompact(y){let w=i.BYTES,_=q("compactSignature",y,w*2);return new g(i.fromBytes(_.subarray(0,w)),i.fromBytes(_.subarray(w,w*2)))}static fromDER(y){let{r:w,s:_}=Mt.toSig(q("DER",y));return new g(w,_)}assertValidity(){}addRecoveryBit(y){return new g(this.r,this.s,y)}recoverPublicKey(y){let w=s.ORDER,{r:_,s:A,recovery:C}=this;if(C==null||![0,1,2,3].includes(C))throw new Error("recovery id invalid");if(a*Pf<w&&C>1)throw new Error("recovery id is ambiguous for h>1 curve");let O=C===2||C===3?_+a:_;if(!s.isValid(O))throw new Error("recovery id 2 or 3 invalid");let j=s.toBytes(O),M=e.fromHex(mt(_i((C&1)===0),j)),R=i.inv(O),Z=I(q("msgHash",y)),X=i.create(-Z*R),ot=i.create(A*R),H=e.BASE.multiplyUnsafe(X).add(M.multiplyUnsafe(ot));if(H.is0())throw new Error("point at infinify");return H.assertValidity(),H}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new g(this.r,i.neg(this.s),this.recovery):this}toBytes(y){if(y==="compact")return mt(i.toBytes(this.r),i.toBytes(this.s));if(y==="der")return Ee(Mt.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return It(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return It(this.toBytes("compact"))}}let b=Bi(i,r.allowedPrivateKeyLengths,r.wrapPrivateKey),S={isValidPrivateKey(d){try{return b(d),!0}catch{return!1}},normPrivateKeyToScalar:b,randomPrivateKey:()=>{let d=a;return Zs(n(qn(d)),d)},precompute(d=8,y=e.BASE){return y.precompute(d,!1)}};function E(d,y=!0){return e.fromPrivateKey(d).toBytes(y)}function m(d){if(typeof d=="bigint")return!1;if(d instanceof e)return!0;let w=q("key",d).length,_=s.BYTES,A=_+1,C=2*_+1;if(!(r.allowedPrivateKeyLengths||i.BYTES===A))return w===A||w===C}function v(d,y,w=!0){if(m(d)===!0)throw new Error("first arg must be private key");if(m(y)===!1)throw new Error("second arg must be public key");return e.fromHex(y).multiply(b(d)).toBytes(w)}let T=t.bits2int||function(d){if(d.length>8192)throw new Error("input is too large");let y=Se(d),w=d.length*8-c;return w>0?y>>BigInt(w):y},I=t.bits2int_modN||function(d){return i.create(T(d))},L=ne(c);function p(d){return Zt("num < 2^"+c,d,er,L),i.toBytes(d)}function P(d,y,w=D){if(["recovered","canonical"].some(ot=>ot in w))throw new Error("sign() legacy options not supported");let{hash:_}=t,{lowS:A,prehash:C,extraEntropy:U}=w;A==null&&(A=!0),d=q("msgHash",d),Ii(w),C&&(d=q("prehashed msgHash",_(d)));let O=I(d),j=b(y),M=[p(j),p(O)];if(U!=null&&U!==!1){let ot=U===!0?n(s.BYTES):U;M.push(q("extraEntropy",ot))}let R=mt(...M),Z=O;function X(ot){let H=T(ot);if(!i.isValidNot0(H))return;let ct=i.inv(H),Le=e.BASE.multiply(H).toAffine(),fe=i.create(Le.x);if(fe===er)return;let Xt=i.create(ct*i.create(Z+fe*j));if(Xt===er)return;let en=(Le.x===fe?0:2)|Number(Le.y&rr),ue=Xt;return A&&l(Xt)&&(ue=f(Xt),en^=1),new g(fe,ue,en)}return{seed:R,k2sig:X}}let D={lowS:t.lowS,prehash:!1},B={lowS:t.lowS,prehash:!1};function h(d,y,w=D){let{seed:_,k2sig:A}=P(d,y,w);return ks(t.hash.outputLen,i.BYTES,o)(_,A)}e.BASE.precompute(8);function x(d,y,w,_=B){let A=d;y=q("msgHash",y),w=q("publicKey",w),Ii(_);let{lowS:C,prehash:U,format:O}=_;if("strict"in _)throw new Error("options.strict was renamed to lowS");if(O!==void 0&&!["compact","der","js"].includes(O))throw new Error('format must be "compact", "der" or "js"');let j=typeof A=="string"||xe(A),M=!j&&!O&&typeof A=="object"&&A!==null&&typeof A.r=="bigint"&&typeof A.s=="bigint";if(!j&&!M)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let R,Z;try{if(M)if(O===void 0||O==="js")R=new g(A.r,A.s);else throw new Error("invalid format");if(j){try{O!=="compact"&&(R=g.fromDER(A))}catch(ue){if(!(ue instanceof Mt.Err))throw ue}!R&&O!=="der"&&(R=g.fromCompact(A))}Z=e.fromHex(w)}catch{return!1}if(!R||C&&R.hasHighS())return!1;U&&(y=t.hash(y));let{r:X,s:ot}=R,H=I(y),ct=i.inv(ot),Le=i.create(H*ct),fe=i.create(X*ct),Xt=e.BASE.multiplyUnsafe(Le).add(Z.multiplyUnsafe(fe));return Xt.is0()?!1:i.create(Xt.x)===X}return Object.freeze({getPublicKey:E,getSharedSecret:v,sign:h,verify:x,utils:S,Point:e,Signature:g})}function Kf(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,n=vt(t.n,e.nBitLength),o={Fp:r,Fn:n,allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:o}}function Nf(e){let{CURVE:t,curveOpts:r}=Kf(e),n={hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,ecdsaOpts:n}}function kf(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}function Ci(e){let{CURVE:t,curveOpts:r,ecdsaOpts:n}=Nf(e),o=Uf(t,r),s=Rf(o,n,r);return kf(e,s)}function Ti(e,t){let r=n=>Ci({...e,hash:n});return{...r(t),create:r}}var Nr={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},Tp=BigInt(0),Mf=BigInt(1),_o=BigInt(2),Di=(e,t)=>(e+t/_o)/t;function Hf(e){let t=Nr.p,r=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),a=BigInt(44),c=BigInt(88),l=e*e*e%t,f=l*l*e%t,u=V(f,r,t)*f%t,g=V(u,r,t)*f%t,b=V(g,_o,t)*l%t,S=V(b,o,t)*b%t,E=V(S,s,t)*S%t,m=V(E,a,t)*E%t,v=V(m,c,t)*m%t,T=V(v,a,t)*E%t,I=V(T,r,t)*f%t,L=V(I,i,t)*S%t,p=V(L,n,t)*l%t,P=V(p,_o,t);if(!Co.eql(Co.sqr(P),e))throw new Error("Cannot find square root");return P}var Co=vt(Nr.p,void 0,void 0,{sqrt:Hf}),De=Ti({...Nr,Fp:Co,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=Nr.n,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Mf*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,i=BigInt("0x100000000000000000000000000000000"),a=Di(s*e,t),c=Di(-n*e,t),l=F(e-a*r-c*o,t),f=F(-a*n-c*s,t),u=l>i,g=f>i;if(u&&(l=t-l),g&&(f=t-f),l>i||f>i)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:u,k1:l,k2neg:g,k2:f}}}},gr);function Pi(e,t,r,n){let o=ke.digest(r instanceof Uint8Array?r:r.subarray());if(_r(o))return o.then(({digest:s})=>(n?.signal?.throwIfAborted(),De.verify(t,s,e))).catch(s=>{throw s.name==="AbortError"?s:new Ye(String(s))});try{return n?.signal?.throwIfAborted(),De.verify(t,o.digest,e)}catch(s){throw new Ye(String(s))}}var kr=class{type="secp256k1";raw;_key;constructor(t){this._key=Oi(t),this.raw=Li(this._key)}toMultihash(){return Et.digest(Ft(this))}toCID(){return W.createV1(114,this.toMultihash())}toString(){return z.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:J(this.raw,t.raw)}verify(t,r,n){return Pi(this._key,r,t,n)}};function To(e){return new kr(e)}function Li(e){return De.ProjectivePoint.fromHex(e).toRawBytes(!0)}function Oi(e){try{return De.ProjectivePoint.fromHex(e),e}catch(t){throw new le(String(t))}}function Ui(e,t){let{Type:r,Data:n}=Ct.decode(e),o=n??new Uint8Array;switch(r){case $.RSA:return So(o,t);case $.Ed25519:return Zn(o);case $.secp256k1:return To(o);case $.ECDSA:return Ln(o);default:throw new he}}function Ri(e){let{Type:t,Data:r}=Ct.decode(e.digest),n=r??new Uint8Array;switch(t){case $.Ed25519:return Zn(n);case $.secp256k1:return To(n);case $.ECDSA:return Ln(n);default:throw new he}}function Ft(e){return Ct.encode({Type:$[e.type],Data:e.raw})}var nr;(function(e){let t;e.codec=()=>(t==null&&(t=kt((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.publicKey!=null&&r.publicKey.byteLength>0&&(n.uint32(10),n.bytes(r.publicKey)),r.payloadType!=null&&r.payloadType.byteLength>0&&(n.uint32(18),n.bytes(r.payloadType)),r.payload!=null&&r.payload.byteLength>0&&(n.uint32(26),n.bytes(r.payload)),r.signature!=null&&r.signature.byteLength>0&&(n.uint32(42),n.bytes(r.signature)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let s={publicKey:et(0),payloadType:et(0),payload:et(0),signature:et(0)},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let a=r.uint32();switch(a>>>3){case 1:{s.publicKey=r.bytes();break}case 2:{s.payloadType=r.bytes();break}case 3:{s.payload=r.bytes();break}case 5:{s.signature=r.bytes();break}default:{r.skipType(a&7);break}}}return s})),t),e.encode=r=>Nt(r,e.codec()),e.decode=(r,n)=>Kt(r,e.codec(),n)})(nr||(nr={}));var Mr=class extends Error{constructor(t="Invalid signature"){super(t),this.name="InvalidSignatureError"}};var Hr=class e{static createFromProtobuf=t=>{let r=nr.decode(t),n=Ui(r.publicKey);return new e({publicKey:n,payloadType:r.payloadType,payload:r.payload,signature:r.signature})};static seal=async(t,r,n)=>{if(r==null)throw new Error("Missing private key");let o=t.domain,s=t.codec,i=t.marshal(),a=Ki(o,s,i),c=await r.sign(a.subarray(),n);return new e({publicKey:r.publicKey,payloadType:s,payload:i,signature:c})};static openAndCertify=async(t,r,n)=>{let o=e.createFromProtobuf(t);if(!await o.validate(r,n))throw new Mr("Envelope signature is not valid for the given domain");return o};publicKey;payloadType;payload;signature;marshaled;constructor(t){let{publicKey:r,payloadType:n,payload:o,signature:s}=t;this.publicKey=r,this.payloadType=n,this.payload=o,this.signature=s}marshal(){return this.marshaled==null&&(this.marshaled=nr.encode({publicKey:Ft(this.publicKey),payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(t){return t==null?!1:J(this.marshal(),t.marshal())}async validate(t,r){let n=Ki(t,this.payloadType,this.payload);return this.publicKey.verify(n.subarray(),this.signature,r)}},Ki=(e,t,r)=>{let n=N(e),o=Tr(n.byteLength),s=Tr(t.length),i=Tr(r.length);return new ft(o,n,s,t,i,r)};var Ni=Symbol.for("nodejs.util.inspect.custom"),qf=114,or=class{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[nn]=!0;toString(){return this.string==null&&(this.string=z.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return W.createV1(qf,this.multihash)}toJSON(){return this.toString()}equals(t){if(t==null)return!1;if(t instanceof Uint8Array)return J(this.multihash.bytes,t);if(typeof t=="string")return this.toString()===t;if(t?.toMultihash()?.bytes!=null)return J(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[Ni](){return`PeerId(${this.toString()})`}},qr=class extends or{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Vr=class extends or{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}},zr=class extends or{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}},Vf=2336,Fr=class{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=Et.digest(N(this.url))}[Ni](){return`PeerId(${this.url})`}[nn]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return W.createV1(Vf,this.toMultihash())}toJSON(){return this.toString()}equals(t){return t==null?!1:(t instanceof Uint8Array&&(t=K(t)),t.toString()===this.toString())}};function ki(e){if(Ff(e))return new qr({multihash:e});if(zf(e))try{let t=Ri(e);if(t.type==="Ed25519")return new Vr({multihash:e,publicKey:t});if(t.type==="secp256k1")return new zr({multihash:e,publicKey:t})}catch{let r=K(e.digest);return new Fr(new URL(r))}throw new ur("Supplied PeerID Multihash is invalid")}function zf(e){return e.code===Et.code}function Ff(e){return e.code===ke.code}function Mi(e,t){let r=(n,o)=>n.toString().localeCompare(o.toString());return e.length!==t.length?!1:(t.sort(r),e.sort(r).every((n,o)=>t[o].equals(n)))}var nt=class extends Error{static name="InvalidMultiaddrError";name="InvalidMultiaddrError"},Ht=class extends Error{static name="ValidationError";name="ValidationError"},sr=class extends Error{static name="InvalidParametersError";name="InvalidParametersError"},Gr=class extends Error{static name="UnknownProtocolError";name="UnknownProtocolError"};var jr=class{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){let r=this.index,n=t();return n===void 0&&(this.index=r),n}parseWith(t){let r=t();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{let r=this.readChar();if(r===t)return r})}readSeparator(t,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,r,n,o){return this.readAtomically(()=>{let s=0,i=0,a=this.peekChar();if(a===void 0)return;let c=a==="0",l=2**(8*o)-1;for(;;){let f=this.readAtomically(()=>{let u=this.readChar();if(u===void 0)return;let g=Number.parseInt(u,t);if(!Number.isNaN(g))return g});if(f===void 0)break;if(s*=t,s+=f,s>l||(i+=1,r!==void 0&&i>r))return}if(i!==0)return!n&&c&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{let t=new Uint8Array(4);for(let r=0;r<t.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[r]=n}return t})}readIPv6Addr(){let t=r=>{for(let n=0;n<r.length/2;n++){let o=n*2;if(n<r.length-3){let i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return r[o]=i[0],r[o+1]=i[1],r[o+2]=i[2],r[o+3]=i[3],[o+4,!0]}let s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];r[o]=s>>8,r[o+1]=s&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,o]=t(r);if(n===16)return r;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let s=new Uint8Array(14),i=16-(n+2),[a]=t(s.subarray(0,i));return r.set(s.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var Gf=45,jf=15,$r=new jr;function Do(e){if(!(e.length>jf))return $r.new(e).parseWith(()=>$r.readIPv4Addr())}function Po(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>Gf))return $r.new(e).parseWith(()=>$r.readIPv6Addr())}function Zr(e){return!!Do(e)}function qi(e){return!!Po(e)}function Oo(e){return t=>K(t,e)}function Uo(e){return t=>N(t,e)}function Pe(e){return new DataView(e.buffer).getUint16(e.byteOffset).toString()}function ce(e){let t=new ArrayBuffer(2);return new DataView(t).setUint16(0,typeof e=="string"?parseInt(e):e),new Uint8Array(t)}function Vi(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);let r=N(t[0],"base32"),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=ce(n);return Dt([r,o],r.length+o.length)}function zi(e){let t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);let r=Vt.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let o=ce(n);return Dt([r,o],r.length+o.length)}function Ro(e){let t=e.subarray(0,e.length-2),r=e.subarray(e.length-2),n=K(t,"base32"),o=Pe(r);return`${n}:${o}`}var Ko=function(e){e=e.toString().trim();let t=new Uint8Array(4);return e.split(/\./g).forEach((r,n)=>{let o=parseInt(r,10);if(isNaN(o)||o<0||o>255)throw new nt("Invalid byte value in IP address");t[n]=o}),t},Fi=function(e){let t=0;e=e.toString().trim();let r=e.split(":",8),n;for(n=0;n<r.length;n++){let s=Zr(r[n]),i;s&&(i=Ko(r[n]),r[n]=K(i.subarray(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,K(i.subarray(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);let s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}let o=new Uint8Array(t+16);for(n=0;n<r.length;n++){r[n]===""&&(r[n]="0");let s=parseInt(r[n],16);if(isNaN(s)||s<0||s>65535)throw new nt("Invalid byte value in IP address");o[t++]=s>>8&255,o[t++]=s&255}return o},Gi=function(e){if(e.byteLength!==4)throw new nt("IPv4 address was incorrect length");let t=[];for(let r=0;r<e.byteLength;r++)t.push(e[r]);return t.join(".")},ji=function(e){if(e.byteLength!==16)throw new nt("IPv6 address was incorrect length");let t=[];for(let n=0;n<e.byteLength;n+=2){let o=e[n],s=e[n+1],i=`${o.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}`;t.push(i)}let r=t.join(":");try{let n=new URL(`http://[${r}]`);return n.hostname.substring(1,n.hostname.length-1)}catch{throw new nt(`Invalid IPv6 address "${r}"`)}};function $i(e){try{let t=new URL(`http://[${e}]`);return t.hostname.substring(1,t.hostname.length-1)}catch{throw new nt(`Invalid IPv6 address "${e}"`)}}var Lo=Object.values(Me).map(e=>e.decoder),$f=function(){let e=Lo[0].or(Lo[1]);return Lo.slice(2).forEach(t=>e=e.or(t)),e}();function Zi(e){return $f.decode(e)}function Wi(e){return t=>e.encoder.encode(t)}function Zf(e){if(parseInt(e).toString()!==e)throw new Ht("Value must be an integer")}function Wf(e){if(e<0)throw new Ht("Value must be a positive integer, or zero")}function Yf(e){return t=>{if(t>e)throw new Ht(`Value must be smaller than or equal to ${e}`)}}function Xf(...e){return t=>{for(let r of e)r(t)}}var ir=Xf(Zf,Wf,Yf(65535));var tt=-1,No=class{protocolsByCode=new Map;protocolsByName=new Map;getProtocol(t){let r;if(typeof t=="string"?r=this.protocolsByName.get(t):r=this.protocolsByCode.get(t),r==null)throw new Gr(`Protocol ${t} was unknown`);return r}addProtocol(t){this.protocolsByCode.set(t.code,t),this.protocolsByName.set(t.name,t),t.aliases?.forEach(r=>{this.protocolsByName.set(r,t)})}removeProtocol(t){let r=this.protocolsByCode.get(t);r!=null&&(this.protocolsByCode.delete(r.code),this.protocolsByName.delete(r.name),r.aliases?.forEach(n=>{this.protocolsByName.delete(n)}))}},bt=new No,_u=[{code:4,name:"ip4",size:32,valueToBytes:Ko,bytesToValue:Gi,validate:e=>{if(!Zr(e))throw new Ht(`Invalid IPv4 address "${e}"`)}},{code:6,name:"tcp",size:16,valueToBytes:ce,bytesToValue:Pe,validate:ir},{code:273,name:"udp",size:16,valueToBytes:ce,bytesToValue:Pe,validate:ir},{code:33,name:"dccp",size:16,valueToBytes:ce,bytesToValue:Pe,validate:ir},{code:41,name:"ip6",size:128,valueToBytes:Fi,bytesToValue:ji,stringToValue:$i,validate:e=>{if(!qi(e))throw new Ht(`Invalid IPv6 address "${e}"`)}},{code:42,name:"ip6zone",size:tt},{code:43,name:"ipcidr",size:8,bytesToValue:Oo("base10"),valueToBytes:Uo("base10")},{code:53,name:"dns",size:tt,resolvable:!0},{code:54,name:"dns4",size:tt,resolvable:!0},{code:55,name:"dns6",size:tt,resolvable:!0},{code:56,name:"dnsaddr",size:tt,resolvable:!0},{code:132,name:"sctp",size:16,valueToBytes:ce,bytesToValue:Pe,validate:ir},{code:301,name:"udt"},{code:302,name:"utp"},{code:400,name:"unix",size:tt,path:!0,stringToValue:e=>decodeURIComponent(e),valueToString:e=>encodeURIComponent(e)},{code:421,name:"p2p",aliases:["ipfs"],size:tt,bytesToValue:Oo("base58btc"),valueToBytes:e=>e.startsWith("Q")||e.startsWith("1")?Uo("base58btc")(e):W.parse(e).multihash.bytes},{code:444,name:"onion",size:96,bytesToValue:Ro,valueToBytes:Vi},{code:445,name:"onion3",size:296,bytesToValue:Ro,valueToBytes:zi},{code:446,name:"garlic64",size:tt},{code:447,name:"garlic32",size:tt},{code:448,name:"tls"},{code:449,name:"sni",size:tt},{code:454,name:"noise"},{code:460,name:"quic"},{code:461,name:"quic-v1"},{code:465,name:"webtransport"},{code:466,name:"certhash",size:tt,bytesToValue:Wi(xn),valueToBytes:Zi},{code:480,name:"http"},{code:481,name:"http-path",size:tt,stringToValue:e=>`/${decodeURIComponent(e)}`,valueToString:e=>encodeURIComponent(e.substring(1))},{code:443,name:"https"},{code:477,name:"ws"},{code:478,name:"wss"},{code:479,name:"p2p-websocket-star"},{code:277,name:"p2p-stardust"},{code:275,name:"p2p-webrtc-star"},{code:276,name:"p2p-webrtc-direct"},{code:280,name:"webrtc-direct"},{code:281,name:"webrtc"},{code:290,name:"p2p-circuit"},{code:777,name:"memory",size:tt}];_u.forEach(e=>{bt.addProtocol(e)});function Yi(e){let t=[],r=0;for(;r<e.length;){let n=to(e,r),o=bt.getProtocol(n),s=xt(n),i=Cu(o,e,r+s),a=0;i>0&&o.size===tt&&(a=xt(i));let c=s+a+i,l={code:n,name:o.name,bytes:e.subarray(r,r+c)};if(i>0){let f=r+s+a,u=e.subarray(f,f+i);l.value=o.bytesToValue?.(u)??K(u)}t.push(l),r+=c}return t}function Xi(e){let t=0,r=[];for(let n of e){if(n.bytes==null){let o=bt.getProtocol(n.code),s=xt(n.code),i,a=0,c=0;n.value!=null&&(i=o.valueToBytes?.(n.value)??N(n.value),a=i.byteLength,o.size===tt&&(c=xt(a)));let l=new Uint8Array(s+c+a),f=0;_e(n.code,l,f),f+=s,i!=null&&(o.size===tt&&(_e(a,l,f),f+=c),l.set(i,f)),n.bytes=l}r.push(n.bytes),t+=n.bytes.byteLength}return Dt(r,t)}function Ji(e){if(e.charAt(0)!=="/")throw new nt('String multiaddr must start with "/"');let t=[],r="protocol",n="",o="";for(let s=1;s<e.length;s++){let i=e.charAt(s);i!=="/"&&(r==="protocol"?o+=e.charAt(s):n+=e.charAt(s));let a=s===e.length-1;if(i==="/"||a){let c=bt.getProtocol(o);if(r==="protocol"){if(c.size==null||c.size===0){t.push({code:c.code,name:c.name}),n="",o="",r="protocol";continue}else if(a)throw new nt(`Component ${o} was missing value`);r="value"}else if(r==="value"){let l={code:c.code,name:c.name};if(c.size!=null&&c.size!==0){if(n==="")throw new nt(`Component ${o} was missing value`);l.value=c.stringToValue?.(n)??n}t.push(l),n="",o="",r="protocol"}}}if(o!==""&&n!=="")throw new nt("Incomplete multiaddr");return t}function Qi(e){return`/${e.flatMap(t=>{if(t.value==null)return t.name;let r=bt.getProtocol(t.code);if(r==null)throw new nt(`Unknown protocol code ${t.code}`);return[t.name,r.valueToString?.(t.value)??t.value]}).join("/")}`}function Cu(e,t,r){return e.size==null||e.size===0?0:e.size>0?e.size/8:to(t,r)}var Tu=Symbol.for("nodejs.util.inspect.custom"),Go=Symbol.for("@multiformats/multiaddr"),Du=[53,54,55,56],Fo=class extends Error{constructor(t="No available resolver"){super(t),this.name="NoAvailableResolverError"}};function Pu(e){if(e==null&&(e="/"),ea(e))return e.getComponents();if(e instanceof Uint8Array)return Yi(e);if(typeof e=="string")return e=e.replace(/\/(\/)+/,"/").replace(/(\/)+$/,""),e===""&&(e="/"),Ji(e);if(Array.isArray(e))return e;throw new nt("Must be a string, Uint8Array, Component[], or another Multiaddr")}var Qr=class e{[Go]=!0;#t;#e;#r;constructor(t="/",r={}){this.#t=Pu(t),r.validate!==!1&&Lu(this)}get bytes(){return this.#r==null&&(this.#r=Xi(this.#t)),this.#r}toString(){return this.#e==null&&(this.#e=Qi(this.#t)),this.#e}toJSON(){return this.toString()}toOptions(){let t,r,n,o,s="";for(let{code:a,name:c,value:l}of this.#t)a===42&&(s=`%${l??""}`),Du.includes(a)&&(r="tcp",o=443,n=`${l??""}${s}`,t=a===55?6:4),(a===6||a===273)&&(r=c==="tcp"?"tcp":"udp",o=parseInt(l??"")),(a===4||a===41)&&(r="tcp",n=`${l??""}${s}`,t=a===41?6:4);if(t==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:r,port:o}}getComponents(){return[...this.#t]}protos(){return this.#t.map(({code:t,value:r})=>{let n=bt.getProtocol(t);return{code:t,size:n.size??0,name:n.name,resolvable:!!n.resolvable,path:!!n.path}})}protoCodes(){return this.#t.map(({code:t})=>t)}protoNames(){return this.#t.map(({name:t})=>t)}tuples(){return this.#t.map(({code:t,value:r})=>{if(r==null)return[t];let n=bt.getProtocol(t),o=[t];return r!=null&&o.push(n.valueToBytes?.(r)??N(r)),o})}stringTuples(){return this.#t.map(({code:t,value:r})=>r==null?[t]:[t,r])}encapsulate(t){let r=new e(t);return new e([...this.#t,...r.getComponents()],{validate:!1})}decapsulate(t){let r=t.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new sr(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new e(n.slice(0,o),{validate:!1})}decapsulateCode(t){let r;for(let n=this.#t.length-1;n>-1;n--)if(this.#t[n].code===t){r=n;break}return new e(this.#t.slice(0,r),{validate:!1})}getPeerId(){try{let t=[];this.#t.forEach(({code:n,value:o})=>{n===421&&t.push([n,o]),n===290&&(t=[])});let r=t.pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?K(z.decode(`z${n}`),"base58btc"):K(W.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){for(let t of this.#t)if(bt.getProtocol(t.code).path)return t.value??null;return null}equals(t){return J(this.bytes,t.bytes)}async resolve(t){let r=this.protos().find(s=>s.resolvable);if(r==null)return[this];let n=ta.get(r.name);if(n==null)throw new Fo(`no available resolver for ${r.name}`);return(await n(this,t)).map(s=>cr(s))}nodeAddress(){let t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(){return!(this.#t.length!==2||this.#t[0].code!==4&&this.#t[0].code!==41||this.#t[1].code!==6&&this.#t[1].code!==273)}[Tu](){return`Multiaddr(${this.toString()})`}};function Lu(e){e.getComponents().forEach(t=>{let r=bt.getProtocol(t.code);t.value!=null&&r.validate?.(t.value)})}var km=parseInt("0xFFFF",16),Mm=new Uint8Array([0,0,0,0,0,0,0,0,0,0,255,255]);var ta=new Map;function ea(e){return!!e?.[Go]}function cr(e){return new Qr(e)}var oa="libp2p-peer-record",sa=Uint8Array.from([3,1]);var fr;(function(e){let t;(function(n){let o;n.codec=()=>(o==null&&(o=kt((s,i,a={})=>{a.lengthDelimited!==!1&&i.fork(),s.multiaddr!=null&&s.multiaddr.byteLength>0&&(i.uint32(10),i.bytes(s.multiaddr)),a.lengthDelimited!==!1&&i.ldelim()},(s,i,a={})=>{let c={multiaddr:et(0)},l=i==null?s.len:s.pos+i;for(;s.pos<l;){let f=s.uint32();switch(f>>>3){case 1:{c.multiaddr=s.bytes();break}default:{s.skipType(f&7);break}}}return c})),o),n.encode=s=>Nt(s,n.codec()),n.decode=(s,i)=>Kt(s,n.codec(),i)})(t=e.AddressInfo||(e.AddressInfo={}));let r;e.codec=()=>(r==null&&(r=kt((n,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),n.peerId!=null&&n.peerId.byteLength>0&&(o.uint32(10),o.bytes(n.peerId)),n.seq!=null&&n.seq!==0n&&(o.uint32(16),o.uint64(n.seq)),n.addresses!=null)for(let i of n.addresses)o.uint32(26),e.AddressInfo.codec().encode(i,o);s.lengthDelimited!==!1&&o.ldelim()},(n,o,s={})=>{let i={peerId:et(0),seq:0n,addresses:[]},a=o==null?n.len:n.pos+o;for(;n.pos<a;){let c=n.uint32();switch(c>>>3){case 1:{i.peerId=n.bytes();break}case 2:{i.seq=n.uint64();break}case 3:{if(s.limits?.addresses!=null&&i.addresses.length===s.limits.addresses)throw new Or('Decode error - map field "addresses" had too many elements');i.addresses.push(e.AddressInfo.codec().decode(n,n.uint32(),{limits:s.limits?.addresses$}));break}default:{n.skipType(c&7);break}}}return i})),r),e.encode=n=>Nt(n,e.codec()),e.decode=(n,o)=>Kt(n,e.codec(),o)})(fr||(fr={}));var tn=class e{static createFromProtobuf=t=>{let r=fr.decode(t),n=ki(Ke(r.peerId)),o=(r.addresses??[]).map(i=>cr(i.multiaddr)),s=r.seq;return new e({peerId:n,multiaddrs:o,seqNumber:s})};static DOMAIN=oa;static CODEC=sa;peerId;multiaddrs;seqNumber;domain=e.DOMAIN;codec=e.CODEC;marshaled;constructor(t){let{peerId:r,multiaddrs:n,seqNumber:o}=t;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=o??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=fr.encode({peerId:this.peerId.toMultihash().bytes,seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(t=>({multiaddr:t.bytes}))})),this.marshaled}equals(t){return!(!(t instanceof e)||!this.peerId.equals(t.peerId)||this.seqNumber!==t.seqNumber||!Mi(this.multiaddrs,t.multiaddrs))}};return ua(Nu);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/utils.js:
@noble/curves/esm/abstract/modular.js:
@noble/curves/esm/abstract/curve.js:
@noble/curves/esm/abstract/edwards.js:
@noble/curves/esm/ed25519.js:
@noble/curves/esm/abstract/weierstrass.js:
@noble/curves/esm/_shortw_utils.js:
@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerRecord}));
//# sourceMappingURL=index.min.js.map
